(function(w,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(w=typeof globalThis<"u"?globalThis:w||self,e((w.dw=w.dw||{},w.dw["uiroll-list"]={}),w.Vue))})(this,function(w,e){"use strict";const Y=(t,n)=>(t.install=function(s){if(t){const i=t.name||t.__name;if(i||n){const r=n?`dw-${n}`:"dw-"+i.replace(/dw/gi,"").toLowerCase();s.component(r,t)}else console.error(t,n,!n)}},t),Z=t=>Array.isArray(t);function H(t){const n=`vi-${t}`;return{n:r=>r?r.startsWith("-")?`${n}${r}`:`${n}_${r}`:n,classes:(...r)=>r.map(c=>{if(Z(c)){const[u,h,d=null]=c;return u?h:d}return c})}}const R={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:6},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[1,3,4]},loopTime:{type:Number,default:1e3*3},scrollTransition:{type:Number,default:1e3*2},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-width":"800","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-attract-bg-color-style":"single","tr-attract-bg-color-to":"#00DEFF","tr-attract-bg-color-from":"#FFFFFF","tr-attract-bg-color-angle":"135","tr-attract-bg-color-value":"rgb(211, 228, 242)","tr-un-attract-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","longText-txt-gap":"30"})}},z=function(t,n){for(let[s,i]of Object.entries(n.value))t.style.setProperty("--"+s,i)},j={mounted(t,n){z(t,n)},updated(t,n){z(t,n)},install(t){t.directive("Css",this)}},{n:D}=H(""),tt=(t=D())=>t+"xxxxxxxx".replace(/[xy]/g,function(n){var s=0|16*Math.random(),i=n=="x"?s:8|3&s;return i.toString(16)});class et{constructor(n=[],s=7){this.list=n,this.severalGroups=s,this.windowSliding=new Array(this.severalGroups).fill(0).map((i,r)=>r)}take(n){return this.Sliding(n),this.show()}show(){return this.windowSliding.map(n=>this.list[n])}Sliding(n){this.windowSliding=this.windowSliding.map(s=>{const i=this.list.length,r=s+n;return r<=i-1?r:r-i})}}const G=function(t){const n=t instanceof Array?[]:{};for(let s in t)n[s]=typeof t[s]=="object"?G(t[s]):t[s];return n};function nt(t,n="top",s,i,r){const c=n=="top"?t.scrollTop:n=="left"?t.scrollLeft:0,u=s-c,h=performance.now();function d(){const a=performance.now()-h,C=b(a,c,u,i);n=="top"?t.scrollTop=C:n=="left"&&(t.scrollLeft=C),a<i?requestAnimationFrame(d):r&&r()}function b(m,a,C,S){return m/=S/2,m<1?C/2*m*m+a:(m--,-C/2*(m*(m-2)-1)+a)}requestAnimationFrame(d)}function ot(){let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s==="x"?i:i&3|8).toString(16)})}function rt(t){const n={};return t.map(s=>{const{__id:i,...r}=s,c=JSON.stringify(r);if(!n[c])return n[c]=!0,s;const u=ot();return{...s,__id:u}})}const{n:J}=H("long-text"),K={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"20"})}},Q=e.defineComponent({name:"LongText",emits:["update:text"],props:K,directives:{css:j},setup(t,n){var q;const i="onUpdate:modelValue"in(((q=e.getCurrentInstance())==null?void 0:q.vnode.props)||{}),r=e.ref(null),c=e.ref(null),u=e.ref(null),h=e.ref(null);let d=null;const b=e.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"});let m=0;const a=e.computed(()=>Object.assign(K.dynamicCss.default(),t.dynamicCss)),C=e.computed({get(){return b.isScroll=!0,W(b),t.text},set(x){i&&n.emit("update:text",x)}}),S=()=>{var A,E,B;const x=(A=u==null?void 0:u.value)==null?void 0:A.offsetWidth,k=(E=h==null?void 0:h.value)==null?void 0:E.offsetWidth,I=(B=c==null?void 0:c.value)==null?void 0:B.scrollLeft,L=performance.now();m||(m=L);const $=L-m;x/t.speed*$,k-I<=0?(c.value.scrollLeft-=u.value.offsetWidth,m=0,requestAnimationFrame(S)):c.value&&c.value.scrollLeft++},W=x=>{e.nextTick(()=>{if(r.value&&u.value){const k=r.value.clientWidth,I=u.value.offsetWidth,L=Number(a.value["txt-gap"]),$=I-L;if(k<$){F();const A=()=>{S(),d=requestAnimationFrame(A)};d=requestAnimationFrame(A)}else x&&(x.isScroll=!1)}})},F=()=>d?(cancelAnimationFrame(d),d=null,!0):!1,P=x=>{b.toolTip_x=x.x,b.toolTip_y=x.y,F()},U=()=>{W()};return e.onUnmounted(()=>{d&&(clearInterval(d),d=null)}),()=>e.withDirectives(e.createVNode("div",{class:[J(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r,onMouseenter:P,onMouseleave:U},[e.createVNode("div",{class:J("_scroll"),ref:c},[e.createVNode("span",{ref:u},[C.value,b.isScroll?e.createVNode("span",{class:"seizeASeat"},null):""]),e.createVNode("span",{ref:h},[b.isScroll?C.value:"",b.isScroll?e.createVNode("span",{class:"seizeASeat"},null):""])])]),[[e.resolveDirective("css"),a.value||{}]])}}),{n:V}=H("roll-list"),X=Y(e.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:j},props:R,components:{LongText:Q},setup(t,n){var B;const i="onUpdate:modelValue"in(((B=e.getCurrentInstance())==null?void 0:B.vnode.props)||{}),r=e.reactive({uuid:tt(V("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),c=e.ref(null),u=e.ref();let h=0,d=null;const b={longText:"longText"},m=o=>{o.preventDefault()},a=e.computed(()=>Object.assign(R.dynamicCss.default(),t.dynamicCss)),C=e.computed(()=>{let o={};for(let l in a.value)l.includes("longText")&&(o[l.replace("longText-","")]=a.value[l]);return o}),S=e.computed(()=>t.header),W=()=>{var o;for(let l=0;l<((o=u.value)==null?void 0:o.children.length);l++){const g=u.value.children[l],{attractShowCount:_,header:p,tmp_scaleRule:f}=t;_.includes(l)?(a.value["tr-attract-bg-color-style"]=="double"?g.style.background=`linear-gradient(${a.value["tr-attract-bg-color-angle"]}deg,${a.value["tr-attract-bg-color-from"]},${a.value["tr-attract-bg-color-to"]})`:g.style.background=a.value["tr-attract-bg-color-value"],Array.from(g.children).forEach((y,T)=>{y.style.transform=`scale(${f[0]})`,y.style.flexBasis=p[T].basis+"%"})):(g.style.background=a.value["tr-un-attract-bg-color"],Array.from(g.children).forEach((y,T)=>{y.style.transform=`scale(${f[1]})`,y.style.flexBasis=p[T].basis+"%"}))}},F=e.computed({get(){return d=new et(G(t.modelValue),t.showCount*2),e.nextTick(()=>{W()}),t.modelValue},set(o){i&&n.emit("update:modelValue",o)}}),P=e.computed(()=>{if(r.takeFlag=!r.takeFlag,t.modelValue.length>t.showCount){const o=r.getInventedListDataBridgeInit?t.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return rt(d.take(o))}else return new Array(t.modelValue.length).fill(0).map((o,l)=>F.value[l])}),U=e.computed(()=>{let o=F.value.length;const l=Number(t.itemHeight.replace("px","")),g=o<=t.showCount?o:t.showCount;return l*g+"px"});e.onMounted(()=>{e.watchEffect(()=>{r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),r.rotationTimer=F.value.length>t.showCount&&setInterval(()=>{q()},t.loopTime)})});const q=()=>{var _;const o=c==null?void 0:c.value,l=t.rollCount<=t.showCount?t.rollCount:t.showCount,g=o.scrollHeight-o.clientHeight;h=h+g/t.showCount*l;for(let p=0;p<((_=u.value)==null?void 0:_.children.length);p++){const f=u.value.children[p],{rollCount:y,attractShowCount:T,scrollTransition:N,header:M}=t;f.style.transition=`${N/1e3}s`,T.map(v=>v+y).includes(p)?(a.value["tr-attract-bg-color-style"]=="double"?f.style.background=`linear-gradient(${a.value["tr-attract-bg-color-angle"]}deg,${a.value["tr-attract-bg-color-from"]},${a.value["tr-attract-bg-color-to"]})`:f.style.background=a.value["tr-attract-bg-color-value"],Array.from(f.children).forEach((v,O)=>{v.style.transition=`${N/1e3}s`,v.style.flexBasis=M[O].basis+"%",v.style.transform=`scale(${t.tmp_scaleRule[0]})`})):(f.style.background=a.value["tr-un-attract-bg-color"],Array.from(f.children).forEach((v,O)=>{v.style.transition=`${N/1e3}s`,v.style.flexBasis=M[O].basis+"%",v.style.transform=`scale(${t.tmp_scaleRule[1]})`}))}nt(o,"top",h,t.scrollTransition,()=>{var p;for(let f=0;f<((p=u.value)==null?void 0:p.children.length);f++){const y=u.value.children[f];y.style.transition="0s",Array.from(y.children).forEach(T=>{T.style.transition="0s"})}r.takeFlag=!r.takeFlag,o.scrollTop=0,h=0})},x=()=>{r.rotationTimer&&clearInterval(r.rotationTimer)},k=()=>{r.rotationTimer=null},I=function(o){n.emit&&n.emit("rowClick",o)};e.onUnmounted(()=>{x(),r.rotationTimer=null});const L=()=>t.showHeader?e.createVNode("div",{class:V("_th")},[S.value.map(o=>e.createVNode("div",{class:V("_td"),style:{flexBasis:o.basis+"%"}},[o.label]))]):"",$=()=>e.createVNode("div",{ref:c,onWheel:m,class:V("_scroll"),style:{height:U.value}},[e.createVNode("ul",{ref:u,class:V("_wrapper")},[P.value.map(o=>A(o))])]),A=o=>e.createVNode("li",{key:o.__id,style:{height:t.itemHeight},onClick:I.bind(this,o)},[t.header.map((l,g)=>E(o,l,g))]),E=(o,l,g)=>{var _,p,f,y,T,N,M,v;return e.createVNode("div",{class:[V("_td")]},[e.createVNode("div",{class:[b[(_=S.value[g])==null?void 0:_.type]],style:{color:o[l.prop]?(p=l.fo)==null?void 0:p.color:"none",fontSize:o[l.prop]?((f=l.fo)==null?void 0:f.size)+"px":"auto",fontWeight:o[l.prop]?(y=l.fo)==null?void 0:y.weight:"0",fontFamily:o[l.prop]?(T=l.fo)==null?void 0:T.style:"none"}},[(N=S.value[g])!=null&&N.type&&((M=S.value[g])==null?void 0:M.type)=="longText"?e.createVNode(Q,{text:o[l.prop]||"undefined",speed:o[l.prop]?(v=l.longText)==null?void 0:v.speed:!1,dynamicCss:C.value},null):o[l.prop]||"undefined"])])};return()=>e.withDirectives(e.createVNode("div",{class:V(),onMouseenter:x,onMouseleave:k},[L(),$()]),[[e.resolveDirective("css"),a.value||{}]])}}),"roll-list");w.RollList=X,w.default=X,Object.defineProperties(w,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
