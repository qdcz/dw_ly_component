(function(v,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(v=typeof globalThis<"u"?globalThis:v||self,e((v.dw=v.dw||{},v.dw["uiroll-list"]={}),v.Vue))})(this,function(v,e){"use strict";const W=(t,r)=>(t.install=function(s){if(t){const c=t.name||t.__name;if(c||r){const l=r?`dw-${r}`:"dw-"+c.replace(/dw/gi,"").toLowerCase();s.component(l,t)}else console.error(t,r,!r)}},t),I=t=>Array.isArray(t);function L(t){const r=`vi-${t}`;return{n:l=>l?l.startsWith("-")?`${r}${l}`:`${r}_${l}`:r,classes:(...l)=>l.map(i=>{if(I(i)){const[d,w,y=null]=i;return d?w:y}return i})}}const F={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:6},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[1,3,4]},loopTime:{type:Number,default:1e3*5e3},scrollTransition:{type:Number,default:1e3*2},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},longTextSpeed:{type:Number,default:1e3/60},dynamicCss:{type:Object,default:()=>({"box-width":"800","th-pad-tb":"10","th-bg-color":"#0f2851","th-fo-color":"#df9418","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-attract-bg-color-style":"single","tr-attract-bg-color-to":"#00DEFF","tr-attract-bg-color-from":"#FFFFFF","tr-attract-bg-color-angle":"135","tr-attract-bg-color-value":"#184677","tr-attract-bg-color":"#184677","tr-un-attract-bg-color":"#04172c","td-pad-lr":"20","td-pad-tb":"0"})}},k=function(t,r){for(let[s,c]of Object.entries(r.value))t.style.setProperty("--"+s,c)},_={mounted(t,r){k(t,r)},updated(t,r){k(t,r)},install(t){t.directive("Css",this)}},{n:M}=L(""),P=(t=M())=>t+"xxxxxxxx".replace(/[xy]/g,function(r){var s=0|16*Math.random(),c=r=="x"?s:8|3&s;return c.toString(16)});class q{constructor(r=[],s=7){this.list=r,this.severalGroups=s,this.windowSliding=new Array(this.severalGroups).fill(0).map((c,l)=>l)}take(r){return this.Sliding(r),this.show()}show(){return this.windowSliding.map(r=>this.list[r])}Sliding(r){this.windowSliding=this.windowSliding.map(s=>{const c=this.list.length,l=s+r;return l<=c-1?l:l-c})}}const R=function(t){const r=t instanceof Array?[]:{};for(let s in t)r[s]=typeof t[s]=="object"?R(t[s]):t[s];return r};function z(t,r="top",s,c,l){const i=r=="top"?t.scrollTop:r=="left"?t.scrollLeft:0,d=s-i,w=performance.now();function y(){const a=performance.now()-w,h=x(a,i,d,c);r=="top"?t.scrollTop=h:r=="left"&&(t.scrollLeft=h),a<c?requestAnimationFrame(y):l&&l()}function x(f,a,h,T){return f/=T/2,f<1?h/2*f*f+a:(f--,-h/2*(f*(f-2)-1)+a)}requestAnimationFrame(y)}const{n:D}=L("scroll-text"),O=e.defineComponent({name:"ScrollText",emits:["update:text"],props:{text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3/60}},setup(t,r){var h;const c="onUpdate:modelValue"in(((h=e.getCurrentInstance())==null?void 0:h.vnode.props)||{}),l=e.ref(null),i=e.ref(null),d=e.ref(null),w=e.ref(null);let y=null;const x=e.reactive({isScroll:!0}),f=e.computed({get(){return x.isScroll=!0,e.nextTick(()=>{if(l.value&&d.value){const T=l.value.clientWidth,$=d.value.offsetWidth-20;T<$?(y&&(clearInterval(y),y=null),y=setInterval(a,t.speed)):x.isScroll=!1}}),t.text+""},set(T){c&&r.emit("update:text",T)}}),a=()=>{w.value.offsetWidth-i.value.scrollLeft<=0?i.value.scrollLeft-=d.value.offsetWidth:i.value.scrollLeft++};return()=>e.createVNode("div",{class:D(""),ref:l},[e.createVNode("div",{class:D("_scroll"),ref:i},[e.createVNode("span",{ref:d},[f.value,x.isScroll?e.createVNode("span",{class:"seizeASeat"},null):""]),e.createVNode("span",{ref:w},[x.isScroll?f.value:"",x.isScroll?e.createVNode("span",{class:"seizeASeat"},null):""])])])}}),{n:S}=L("roll-list"),E=W(e.defineComponent({name:"RollList",emits:["update:modelValue"],directives:{css:_},props:F,components:{scrollText:O},setup(t,r){var H;const c="onUpdate:modelValue"in(((H=e.getCurrentInstance())==null?void 0:H.vnode.props)||{}),l=e.reactive({uuid:P(S("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),i=e.ref(null),d=e.ref();let w=0,y=null;const x={longText:"longText"},f=o=>{o.preventDefault()},a=e.computed(()=>Object.assign(F.dynamicCss.default(),t.dynamicCss)),h=e.computed(()=>t.header),T=()=>{var o;for(let n=0;n<((o=d.value)==null?void 0:o.children.length);n++){const g=d.value.children[n],{attractShowCount:V,header:m,tmp_scaleRule:u}=t;V.includes(n)?(a.value["tr-attract-bg-color-style"]=="double"?g.style.background=`linear-gradient(${a.value["tr-attract-bg-color-angle"]}deg,${a.value["tr-attract-bg-color-from"]},${a.value["tr-attract-bg-color-to"]})`:g.style.background=a.value["tr-attract-bg-color-value"],Array.from(g.children).forEach((p,C)=>{p.style.transform=`scale(${u[0]})`,p.style.flexBasis=m[C].basis+"%"})):(g.style.background=a.value["tr-un-attract-bg-color"],Array.from(g.children).forEach((p,C)=>{p.style.transform=`scale(${u[1]})`,p.style.flexBasis=m[C].basis+"%"}))}},$=e.computed({get(){return y=new q(R(t.modelValue),t.showCount*2),e.nextTick(()=>{T()}),t.modelValue},set(o){c&&r.emit("update:modelValue",o)}}),U=e.computed(()=>{if(l.takeFlag=!l.takeFlag,t.modelValue.length>t.showCount){const o=l.getInventedListDataBridgeInit?t.rollCount:(l.getInventedListDataBridgeInit=!0)&&0;return y.take(o)}else return new Array(t.modelValue.length).fill(0).map((o,n)=>$.value[n])}),j=e.computed(()=>{let o=$.value.length;const n=Number(t.itemHeight.replace("px","")),g=o<=t.showCount?o:t.showCount;return n*g+"px"});e.watchEffect(()=>{l.rotationTimer&&(clearInterval(l.rotationTimer),l.rotationTimer=null),l.rotationTimer=$.value.length>t.showCount&&setInterval(()=>{G()},t.loopTime)});const G=()=>{var V;const o=i==null?void 0:i.value,n=t.rollCount<=t.showCount?t.rollCount:t.showCount,g=o.scrollHeight-o.clientHeight;w=w+g/t.showCount*n;for(let m=0;m<((V=d.value)==null?void 0:V.children.length);m++){const u=d.value.children[m],{rollCount:p,attractShowCount:C,scrollTransition:N,header:A}=t;u.style.transition=`${N/1e3}s`,C.map(b=>b+p).includes(m)?(a.value["tr-attract-bg-color-style"]=="double"?u.style.background=`linear-gradient(${a.value["tr-attract-bg-color-angle"]}deg,${a.value["tr-attract-bg-color-from"]},${a.value["tr-attract-bg-color-to"]})`:u.style.background=a.value["tr-attract-bg-color-value"],Array.from(u.children).forEach((b,B)=>{b.style.transition=`${N/1e3}s`,b.style.flexBasis=A[B].basis+"%",b.style.transform=`scale(${t.tmp_scaleRule[0]})`})):(u.style.background=a.value["tr-un-attract-bg-color"],Array.from(u.children).forEach((b,B)=>{b.style.transition=`${N/1e3}s`,b.style.flexBasis=A[B].basis+"%",b.style.transform=`scale(${t.tmp_scaleRule[1]})`}))}z(o,"top",w,t.scrollTransition,()=>{var m;for(let u=0;u<((m=d.value)==null?void 0:m.children.length);u++){const p=d.value.children[u];p.style.transition="0s",Array.from(p.children).forEach(C=>{C.style.transition="0s"})}l.takeFlag=!l.takeFlag,o.scrollTop=0,w=0,T()})};e.nextTick(()=>{});const Q=()=>t.showHeader?e.createVNode("div",{class:S("_th")},[h.value.map(o=>e.createVNode("div",{class:S("_td"),style:{flexBasis:o.basis+"%"}},[o.label]))]):"";return()=>e.withDirectives(e.createVNode("div",{class:S()},[Q(),e.createVNode("div",{ref:i,onWheel:f,class:S("_scroll"),style:{height:j.value}},[e.createVNode("ul",{ref:d,class:S("_wrapper")},[U.value.map(o=>e.createVNode("li",{style:{height:t.itemHeight}},[t.header.map((n,g)=>{var V,m,u,p,C,N,A,b;return e.createVNode("div",{class:[S("_td")]},[e.createVNode("div",{class:[x[(V=h.value[g])==null?void 0:V.type]],style:{color:o[n.prop]?(m=n.fo)==null?void 0:m.color:"none",fontSize:o[n.prop]?((u=n.fo)==null?void 0:u.size)+"px":"auto",fontWeight:o[n.prop]?(p=n.fo)==null?void 0:p.weight:"0",fontFamily:o[n.prop]?(C=n.fo)==null?void 0:C.style:"none"}},[(N=h.value[g])!=null&&N.type&&((A=h.value[g])==null?void 0:A.type)=="longText"?e.createVNode(e.resolveComponent("scrollText"),{text:o[n.prop]||"undefined",speed:o[n.prop]?(b=n.longText)==null?void 0:b.speed:!1},null):o[n.prop]||"undefined"])])})]))])])]),[[e.resolveDirective("css"),a.value||{}]])}}),"roll-list");v.RollList=E,v.default=E,Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
