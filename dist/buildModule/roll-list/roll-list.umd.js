(function(h,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(h=typeof globalThis<"u"?globalThis:h||self,t((h.dw=h.dw||{},h.dw["uiroll-list"]={}),h.Vue))})(this,function(h,t){"use strict";const ne=(e,n)=>(e.install=function(i){if(e){const c=e.name||e.__name;if(c||n){const r=n?`dw-${n}`:"dw-"+c.replace(/dw/gi,"").toLowerCase();i.component(r,e)}else console.error(e,n,!n)}},e),le=e=>Array.isArray(e);function M(e){const n=`vi-${e}`;return{n:r=>r?r.startsWith("-")?`${n}${r}`:`${n}_${r}`:n,classes:(...r)=>r.map(u=>{if(le(u)){const[f,x,g=null]=u;return f?x:g}return u})}}var B=(e=>(e.AUTHROLL="autoRoll",e.HANDMOVE="handRoll",e))(B||{});const G={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:8},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[3,4]},rollType:{type:String,default:"autoRoll",validator:function(e){return Object.values(B).includes(e)}},loopTime:{type:Number,default:1e3*2},scrollTransition:{type:Number,default:1e3*.8},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-wid":"800","pin-hei":"80","pin-radius":"4","pin-dire-b":"120","pin-bg-color-style":"double","pin-bg-color-to":"#00DEFF","pin-bg-color-from":"#FFFFFF","pin-bg-color-angle":"135","pin-bg-color-value":"#49a3cb","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-focus-bg-color-style":"single","tr-focus-bg-color-to":"#00DEFF","tr-focus-bg-color-from":"#FFFFFF","tr-focus-bg-color-angle":"135","tr-focus-bg-color-value":"rgb(211, 228, 242)","tr-un-focus-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","td-txt-align":"center","longText-txt-gap":"30","longText-sco-ani-name":"longTextScrollAnimation","longText-sco-ani-dura":"15"})}},O=function(e,n){for(let[i,c]of Object.entries(n.value))e.style.setProperty("--"+i,c)},U={mounted(e,n){O(e,n)},updated(e,n){O(e,n)},install(e){e.directive("Css",this)}},{n:re}=M(""),se=(e=re())=>e+"xxxxxxxx".replace(/[xy]/g,function(n){var i=0|16*Math.random(),c=n=="x"?i:8|3&i;return c.toString(16)});class ie{constructor(n=[],i=7){this.list=n,this.severalGroups=i,this.windowSliding=new Array(this.severalGroups).fill(0).map((c,r)=>r)}take(n){return this.Sliding(n),this.show()}show(){return this.windowSliding.map(n=>this.list[n])}Sliding(n){this.windowSliding=this.windowSliding.map(i=>{const c=this.list.length,r=i+n;return r<=c-1?r:r-c})}}const R=function(e){const n=e instanceof Array?[]:{};for(let i in e)n[i]=typeof e[i]=="object"?R(e[i]):e[i];return n};function ce(e,n="top",i,c,r){const u=n=="top"?e.scrollTop:n=="left"?e.scrollLeft:0,f=i-u,x=performance.now();function g(){const b=performance.now()-x,s=_(b,u,f,c);n=="top"?e.scrollTop=s:n=="left"&&(e.scrollLeft=s),b<c?requestAnimationFrame(g):r&&r()}function _(m,b,s,L){return m/=L/2,m<1?s/2*m*m+b:(m--,-s/2*(m*(m-2)-1)+b)}requestAnimationFrame(g)}function H(){let e=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const c=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(i==="x"?c:c&3|8).toString(16)})}function ae(e){const n={};return e.map(i=>{const{__id:c,...r}=i,u=JSON.stringify(r);if(!n[u])return n[u]=!0,i;const f=H();return{...i,__id:f}})}const{n:E}=M("long-text"),W={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"22","sco-ani-name":"longTextScrollAnimation","sco-ani-dura":"10"})}},q=t.defineComponent({name:"LongText",emits:["update:text"],props:W,directives:{css:U},setup(e,n){var b;const c="onUpdate:modelValue"in(((b=t.getCurrentInstance())==null?void 0:b.vnode.props)||{}),r=t.ref(null),u=t.ref(null),f=t.ref(null),x=t.ref(null),g=t.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"}),_=t.computed(()=>Object.assign(W.dynamicCss.default(),e.dynamicCss)),m=t.computed({get(){return g.isScroll=!0,e.text},set(s){c&&n.emit("update:text",s)}});return t.onMounted(()=>{t.watchEffect(()=>{t.nextTick(()=>{const s=r.value.clientWidth,A=f.value.offsetWidth;s>=A&&(g.isScroll=!1)})})}),()=>t.withDirectives(t.createVNode("div",{class:[E(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r},[t.createVNode("div",{class:E("_scroll"),ref:u},[t.createVNode("span",{ref:f,class:g.isScroll?"startAnimation":""},[m.value]),g.isScroll?t.createVNode("span",null,[t.createVNode("span",{class:"seizeASeat"},null),t.createVNode("span",{ref:x,class:"startAnimation"},[m.value]),t.createVNode("span",{class:"seizeASeat"},null)]):""])]),[[t.resolveDirective("css"),_.value||{}]])}}),{n:C}=M("roll-list"),P=ne(t.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:U},props:G,components:{LongText:q},setup(e,n){var J;const c="onUpdate:modelValue"in(((J=t.getCurrentInstance())==null?void 0:J.vnode.props)||{}),r=t.reactive({uuid:se(C("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),u=t.ref(null),f=t.ref();let x=0,g=!1,_=null;const m={longText:"longText"},b=l=>{l.preventDefault()},s=t.computed(()=>Object.assign(G.dynamicCss.default(),e.dynamicCss)),L=t.computed(()=>{let l={};for(let o in s.value)o.includes("longText")&&(l[o.replace("longText-","")]=s.value[o]);return l}),A=t.computed(()=>e.header),j=()=>{var l;for(let o=0;o<((l=f.value)==null?void 0:l.children.length);o++){const a=f.value.children[o],{attractShowCount:p,header:d,tmp_scaleRule:T}=e;if(p.includes(o))if(s.value["tr-focus-bg-color-style"]=="double"){const v=s.value["tr-focus-bg-color-angle"],S=s.value["tr-focus-bg-color-from"],y=s.value["tr-focus-bg-color-to"];a.style.background=`linear-gradient(${v}deg,${S},${y})`}else a.style.background=s.value["tr-focus-bg-color-value"];else a.style.background=s.value["tr-un-focus-bg-color"];Array.from(a.children).forEach((w,v)=>{w.style.flexBasis=d[v].basis+"%",p.includes(o)?w.style.transform=`scale(${T[0]})`:w.style.transform=`scale(${T[1]})`})}},F=()=>{if(r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),e.rollType==B.AUTHROLL){if(g)return;r.rotationTimer=k.value.length>e.showCount&&setInterval(()=>{t.nextTick(()=>{fe()})},e.loopTime)}},k=t.computed({get(){const l=e.modelValue.map((o,a)=>(o.__id=H(),o.__uniqueness=H(),o));return _=new ie(R(l),e.showCount*2),t.nextTick(()=>{j()}),l},set(l){c&&n.emit("update:modelValue",l)}}),ue=t.computed(()=>{if(r.takeFlag=!r.takeFlag,e.modelValue.length>e.showCount){const l=r.getInventedListDataBridgeInit?e.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return ae(_.take(l))}else return new Array(e.modelValue.length).fill(0).map((l,o)=>k.value[o])}),de=t.computed(()=>{let l=k.value.length;const o=Number(e.itemHeight.replace("px","")),a=l<=e.showCount?l:e.showCount;return o*a+"px"});t.onMounted(()=>{F(),t.watch(()=>e.rollType,()=>F()),t.watch(()=>e.loopTime,()=>F()),t.watch(()=>k.value,()=>{F()})}),t.onUnmounted(()=>{});const fe=()=>{var p;const l=u==null?void 0:u.value,o=e.rollCount<=e.showCount?e.rollCount:e.showCount,a=l.scrollHeight-l.clientHeight;x=x+a/e.showCount*o;for(let d=0;d<((p=f.value)==null?void 0:p.children.length);d++){const T=f.value.children[d],{attractShowCount:N,header:w,tmp_scaleRule:v}=e,S=N.map(y=>y+o).includes(d);if(S)if(s.value["tr-focus-bg-color-style"]=="double"){const V=s.value["tr-focus-bg-color-angle"],$=s.value["tr-focus-bg-color-from"],I=s.value["tr-focus-bg-color-to"];T.style.background=`linear-gradient(${V}deg,${$},${I})`}else T.style.background=s.value["tr-focus-bg-color-value"];else T.style.background=s.value["tr-un-focus-bg-color"];Array.from(T.children).forEach((y,V)=>{y.style.flexBasis=w[V].basis+"%",S?y.style.transform=`scale(${v[0]})`:y.style.transform=`scale(${v[1]})`})}ce(l,"top",x,e.scrollTransition,()=>{r.takeFlag=!r.takeFlag,l.scrollTop=0,x=0,t.nextTick(()=>{j()})})},z=()=>{g=!0,r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null)},ge=()=>{g=!1,F()},me=function(l){n.emit&&n.emit("rowClick",l)};t.onUnmounted(()=>{z(),r.rotationTimer=null});const pe=()=>{if(!s.value["pin-bg-color-style"])return"";let l="none";if(s.value["pin-bg-color-style"]=="double"){const a=s.value["pin-bg-color-angle"],p=s.value["pin-bg-color-from"],d=s.value["pin-bg-color-to"];l=`linear-gradient(${a}deg,${p},${d})`}else l=s.value["pin-bg-color-value"];return t.createVNode("div",{class:C("_pinSth"),style:{background:l}},null)},xe=()=>e.showHeader?t.createVNode("div",{class:C("_th")},[A.value.map(l=>t.createVNode("div",{class:C("_td"),style:{flexBasis:l.basis+"%"}},[l.label]))]):"",ye=()=>t.createVNode("div",{ref:u,onWheel:b,class:C("_scroll"),style:{height:de.value}},[t.createVNode("ul",{ref:f,class:C("_wrapper")},[ue.value.map(l=>he(l))])]),he=l=>t.createVNode("li",{key:l.__id,style:{height:e.itemHeight},onClick:me.bind(this,l)},[e.header.map((o,a)=>be(l,o,a))]),be=(l,o,a)=>{var T,N,w,v,S,y,V,$,I,K,Q,X,Y,Z,D,ee,te,oe;let p={};o.longText&&((T=o==null?void 0:o.longText)!=null&&T.speed&&(p["sco-ani-dura"]=o.longText.speed),(N=o.longText)!=null&&N.GPUSpee&&(p["sco-ani-name"]=((w=o==null?void 0:o.longText)==null?void 0:w.GPUSpee)==!0?"longTextScrollxAnimation3d":"longTextScrollxAnimation"),((v=o.longText)!=null&&v.txtGap||Number(o.longText.txtGap)==0)&&(p["txt-gap"]=o.longText.txtGap));const d={};return l[o.prop]&&((S=o.fo)!=null&&S.textAlign&&(d.textAlign=(y=o.fo)==null?void 0:y.textAlign),(V=o.fo)!=null&&V.style&&(d.fontFamily=($=o.fo)==null?void 0:$.style),(I=o.fo)!=null&&I.weight&&(d.fontWeight=(K=o.fo)==null?void 0:K.weight),(Q=o.fo)!=null&&Q.color&&(d.color=(X=o.fo)==null?void 0:X.color),(Y=o.fo)!=null&&Y.size&&(d.fontSize=((Z=o.fo)==null?void 0:Z.size)+"px")),t.createVNode("div",{class:[C("_td")]},[t.createVNode("div",{class:[m[(D=A.value[a])==null?void 0:D.type]],style:{...d}},[(ee=A.value[a])!=null&&ee.type&&((te=A.value[a])==null?void 0:te.type)=="longText"?t.createVNode(q,{style:{padding:"0 1px"},text:l[o.prop]||"undefined",speed:l[o.prop]?(oe=o.longText)==null?void 0:oe.speed:!1,dynamicCss:Object.assign(R(L.value),p)},null):l[o.prop]||"undefined"])])};return()=>t.withDirectives(t.createVNode("div",{class:C(),onMouseenter:z,onMouseleave:ge},[pe(),xe(),ye()]),[[t.resolveDirective("css"),s.value||{}]])}}),"roll-list");h.RollList=P,h.default=P,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
