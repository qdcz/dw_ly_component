(function(x,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(x=typeof globalThis<"u"?globalThis:x||self,e((x.dw=x.dw||{},x.dw["uiroll-list"]={}),x.Vue))})(this,function(x,e){"use strict";const Q=(t,n)=>(t.install=function(s){if(t){const a=t.name||t.__name;if(a||n){const r=n?`dw-${n}`:"dw-"+a.replace(/dw/gi,"").toLowerCase();s.component(r,t)}else console.error(t,n,!n)}},t),X=t=>Array.isArray(t);function $(t){const n=`vi-${t}`;return{n:r=>r?r.startsWith("-")?`${n}${r}`:`${n}_${r}`:n,classes:(...r)=>r.map(c=>{if(X(c)){const[u,m,f=null]=c;return u?m:f}return c})}}var B=(t=>(t.AUTHROLL="autoRoll",t.HANDMOVE="handRoll",t))(B||{});const H={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:8},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[3,4]},rollType:{type:String,default:"autoRoll",validator:function(t){return Object.values(B).includes(t)}},loopTime:{type:Number,default:1e3*2},scrollTransition:{type:Number,default:1e3*.8},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-width":"800","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-attract-bg-color-style":"single","tr-attract-bg-color-to":"#00DEFF","tr-attract-bg-color-from":"#FFFFFF","tr-attract-bg-color-angle":"135","tr-attract-bg-color-value":"rgb(211, 228, 242)","tr-un-attract-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","longText-txt-gap":"30","longText-sco-ani-name":"longTextScrollAnimation","longText-sco-ani-dura":"15"})}},O=function(t,n){for(let[s,a]of Object.entries(n.value))t.style.setProperty("--"+s,a)},U={mounted(t,n){O(t,n)},updated(t,n){O(t,n)},install(t){t.directive("Css",this)}},{n:Y}=$(""),Z=(t=Y())=>t+"xxxxxxxx".replace(/[xy]/g,function(n){var s=0|16*Math.random(),a=n=="x"?s:8|3&s;return a.toString(16)});class D{constructor(n=[],s=7){this.list=n,this.severalGroups=s,this.windowSliding=new Array(this.severalGroups).fill(0).map((a,r)=>r)}take(n){return this.Sliding(n),this.show()}show(){return this.windowSliding.map(n=>this.list[n])}Sliding(n){this.windowSliding=this.windowSliding.map(s=>{const a=this.list.length,r=s+n;return r<=a-1?r:r-a})}}const R=function(t){const n=t instanceof Array?[]:{};for(let s in t)n[s]=typeof t[s]=="object"?R(t[s]):t[s];return n};function tt(t,n="top",s,a,r){const c=n=="top"?t.scrollTop:n=="left"?t.scrollLeft:0,u=s-c,m=performance.now();function f(){const y=performance.now()-m,i=V(y,c,u,a);n=="top"?t.scrollTop=i:n=="left"&&(t.scrollLeft=i),y<a?requestAnimationFrame(f):r&&r()}function V(g,y,i,k){return g/=k/2,g<1?i/2*g*g+y:(g--,-i/2*(g*(g-2)-1)+y)}requestAnimationFrame(f)}function et(){let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const a=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s==="x"?a:a&3|8).toString(16)})}function nt(t){const n={};return t.map(s=>{const{__id:a,...r}=s,c=JSON.stringify(r);if(!n[c])return n[c]=!0,s;const u=et();return{...s,__id:u}})}const{n:W}=$("long-text"),G={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"22","sco-ani-name":"longTextScrollAnimation","sco-ani-dura":"10"})}},P=e.defineComponent({name:"LongText",emits:["update:text"],props:G,directives:{css:U},setup(t,n){var y;const a="onUpdate:modelValue"in(((y=e.getCurrentInstance())==null?void 0:y.vnode.props)||{}),r=e.ref(null),c=e.ref(null),u=e.ref(null),m=e.ref(null),f=e.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"}),V=e.computed(()=>Object.assign(G.dynamicCss.default(),t.dynamicCss)),g=e.computed({get(){return f.isScroll=!0,t.text},set(i){a&&n.emit("update:text",i)}});return e.onMounted(()=>{e.watchEffect(()=>{e.nextTick(()=>{const i=r.value.clientWidth,_=u.value.offsetWidth;i>=_&&(f.isScroll=!1)})})}),()=>e.withDirectives(e.createVNode("div",{class:[W(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r},[e.createVNode("div",{class:W("_scroll"),ref:c},[e.createVNode("span",{ref:u,class:f.isScroll?"startAnimation":""},[g.value]),f.isScroll?e.createVNode("span",null,[e.createVNode("span",{class:"seizeASeat"},null),e.createVNode("span",{ref:m,class:"startAnimation"},[g.value]),e.createVNode("span",{class:"seizeASeat"},null)]):""])]),[[e.resolveDirective("css"),V.value||{}]])}}),{n:v}=$("roll-list"),q=Q(e.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:U},props:H,components:{LongText:P},setup(t,n){var z;const a="onUpdate:modelValue"in(((z=e.getCurrentInstance())==null?void 0:z.vnode.props)||{}),r=e.reactive({uuid:Z(v("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),c=e.ref(null),u=e.ref();let m=0,f=!1,V=null;const g={longText:"longText"},y=l=>{l.preventDefault()},i=e.computed(()=>Object.assign(H.dynamicCss.default(),t.dynamicCss)),k=e.computed(()=>{let l={};for(let o in i.value)o.includes("longText")&&(l[o.replace("longText-","")]=i.value[o]);return l}),_=e.computed(()=>t.header),E=()=>{var l;for(let o=0;o<((l=u.value)==null?void 0:l.children.length);o++){const d=u.value.children[o],{attractShowCount:h,header:b,tmp_scaleRule:T}=t;if(h.includes(o))if(i.value["tr-attract-bg-color-style"]=="double"){const C=i.value["tr-attract-bg-color-angle"],S=i.value["tr-attract-bg-color-from"],p=i.value["tr-attract-bg-color-to"];d.style.background=`linear-gradient(${C}deg,${S},${p})`}else d.style.background=i.value["tr-attract-bg-color-value"];else d.style.background=i.value["tr-un-attract-bg-color"];Array.from(d.children).forEach((w,C)=>{w.style.flexBasis=b[C].basis+"%",h.includes(o)?w.style.transform=`scale(${T[0]})`:w.style.transform=`scale(${T[1]})`})}},N=()=>{if(r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),t.rollType==B.AUTHROLL){if(f)return;r.rotationTimer=I.value.length>t.showCount&&setInterval(()=>{e.nextTick(()=>{rt()})},t.loopTime)}},I=e.computed({get(){return V=new D(R(t.modelValue),t.showCount*2),e.nextTick(()=>{E()}),t.modelValue},set(l){a&&n.emit("update:modelValue",l)}}),ot=e.computed(()=>{if(r.takeFlag=!r.takeFlag,t.modelValue.length>t.showCount){const l=r.getInventedListDataBridgeInit?t.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return nt(V.take(l))}else return new Array(t.modelValue.length).fill(0).map((l,o)=>I.value[o])}),lt=e.computed(()=>{let l=I.value.length;const o=Number(t.itemHeight.replace("px","")),d=l<=t.showCount?l:t.showCount;return o*d+"px"});e.onMounted(()=>{N(),e.watch(()=>t.rollType,()=>N()),e.watch(()=>t.loopTime,()=>N()),e.watch(()=>I.value,()=>{N()})}),e.onUnmounted(()=>{});const rt=()=>{var h;const l=c==null?void 0:c.value,o=t.rollCount<=t.showCount?t.rollCount:t.showCount,d=l.scrollHeight-l.clientHeight;m=m+d/t.showCount*o;for(let b=0;b<((h=u.value)==null?void 0:h.children.length);b++){const T=u.value.children[b],{attractShowCount:L,header:w,tmp_scaleRule:C}=t,S=L.map(p=>p+o).includes(b);if(S)if(i.value["tr-attract-bg-color-style"]=="double"){const A=i.value["tr-attract-bg-color-angle"],F=i.value["tr-attract-bg-color-from"],M=i.value["tr-attract-bg-color-to"];T.style.background=`linear-gradient(${A}deg,${F},${M})`}else T.style.background=i.value["tr-attract-bg-color-value"];else T.style.background=i.value["tr-un-attract-bg-color"];Array.from(T.children).forEach((p,A)=>{p.style.flexBasis=w[A].basis+"%",S?p.style.transform=`scale(${C[0]})`:p.style.transform=`scale(${C[1]})`})}tt(l,"top",m,t.scrollTransition,()=>{r.takeFlag=!r.takeFlag,l.scrollTop=0,m=0,e.nextTick(()=>{E()})})},j=()=>{f=!0,r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null)},st=()=>{f=!1,N()},it=function(l){n.emit&&n.emit("rowClick",l)};e.onUnmounted(()=>{j(),r.rotationTimer=null});const at=()=>t.showHeader?e.createVNode("div",{class:v("_th")},[_.value.map(l=>e.createVNode("div",{class:v("_td"),style:{flexBasis:l.basis+"%"}},[l.label]))]):"",ct=()=>e.createVNode("div",{ref:c,onWheel:y,class:v("_scroll"),style:{height:lt.value}},[e.createVNode("ul",{ref:u,class:v("_wrapper")},[ot.value.map(l=>ut(l))])]),ut=l=>e.createVNode("li",{key:l.__id,style:{height:t.itemHeight},onClick:it.bind(this,l)},[t.header.map((o,d)=>dt(l,o,d))]),dt=(l,o,d)=>{var b,T,L,w,C,S,p,A,F,M,J,K;let h={};return o.longText&&((b=o==null?void 0:o.longText)!=null&&b.speed&&(h["sco-ani-dura"]=o.longText.speed),(T=o.longText)!=null&&T.GPUSpee&&(h["sco-ani-name"]=((L=o==null?void 0:o.longText)==null?void 0:L.GPUSpee)==!0?"longTextScrollxAnimation3d":"longTextScrollxAnimation"),((w=o.longText)!=null&&w.txtGap||Number(o.longText.txtGap)==0)&&(h["txt-gap"]=o.longText.txtGap)),e.createVNode("div",{class:[v("_td")]},[e.createVNode("div",{class:[g[(C=_.value[d])==null?void 0:C.type]],style:{color:l[o.prop]?(S=o.fo)==null?void 0:S.color:"none",fontSize:l[o.prop]?((p=o.fo)==null?void 0:p.size)+"px":"auto",fontWeight:l[o.prop]?(A=o.fo)==null?void 0:A.weight:"0",fontFamily:l[o.prop]?(F=o.fo)==null?void 0:F.style:"none"}},[(M=_.value[d])!=null&&M.type&&((J=_.value[d])==null?void 0:J.type)=="longText"?e.createVNode(P,{style:{padding:"0 1px"},text:l[o.prop]||"undefined",speed:l[o.prop]?(K=o.longText)==null?void 0:K.speed:!1,dynamicCss:Object.assign(R(k.value),h)},null):l[o.prop]||"undefined"])])};return()=>e.withDirectives(e.createVNode("div",{class:v(),onMouseenter:j,onMouseleave:st},[at(),ct()]),[[e.resolveDirective("css"),i.value||{}]])}}),"roll-list");x.RollList=q,x.default=q,Object.defineProperties(x,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
