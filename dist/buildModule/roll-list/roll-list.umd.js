(function(h,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(h=typeof globalThis<"u"?globalThis:h||self,t((h.dw=h.dw||{},h.dw["uiroll-list"]={}),h.Vue))})(this,function(h,t){"use strict";const X=(e,l)=>(e.install=function(i){if(e){const c=e.name||e.__name;if(c||l){const r=l?`dw-${l}`:"dw-"+c.replace(/dw/gi,"").toLowerCase();i.component(r,e)}else console.error(e,l,!l)}},e),Y=e=>Array.isArray(e);function M(e){const l=`vi-${e}`;return{n:r=>r?r.startsWith("-")?`${l}${r}`:`${l}_${r}`:l,classes:(...r)=>r.map(u=>{if(Y(u)){const[d,p,f=null]=u;return d?p:f}return u})}}var B=(e=>(e.AUTHROLL="autoRoll",e.HANDMOVE="handRoll",e))(B||{});const G={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:8},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[3,4]},rollType:{type:String,default:"autoRoll",validator:function(e){return Object.values(B).includes(e)}},loopTime:{type:Number,default:1e3*2},scrollTransition:{type:Number,default:1e3*.8},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-wid":"800","pin-hei":"80","pin-radius":"4","pin-dire-b":"120","pin-bg-color-style":"double","pin-bg-color-to":"#00DEFF","pin-bg-color-from":"#FFFFFF","pin-bg-color-angle":"135","pin-bg-color-value":"#49a3cb","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-focus-bg-color-style":"single","tr-focus-bg-color-to":"#00DEFF","tr-focus-bg-color-from":"#FFFFFF","tr-focus-bg-color-angle":"135","tr-focus-bg-color-value":"rgb(211, 228, 242)","tr-un-focus-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","longText-txt-gap":"30","longText-sco-ani-name":"longTextScrollAnimation","longText-sco-ani-dura":"15"})}},O=function(e,l){for(let[i,c]of Object.entries(l.value))e.style.setProperty("--"+i,c)},U={mounted(e,l){O(e,l)},updated(e,l){O(e,l)},install(e){e.directive("Css",this)}},{n:Z}=M(""),D=(e=Z())=>e+"xxxxxxxx".replace(/[xy]/g,function(l){var i=0|16*Math.random(),c=l=="x"?i:8|3&i;return c.toString(16)});class ee{constructor(l=[],i=7){this.list=l,this.severalGroups=i,this.windowSliding=new Array(this.severalGroups).fill(0).map((c,r)=>r)}take(l){return this.Sliding(l),this.show()}show(){return this.windowSliding.map(l=>this.list[l])}Sliding(l){this.windowSliding=this.windowSliding.map(i=>{const c=this.list.length,r=i+l;return r<=c-1?r:r-c})}}const R=function(e){const l=e instanceof Array?[]:{};for(let i in e)l[i]=typeof e[i]=="object"?R(e[i]):e[i];return l};function te(e,l="top",i,c,r){const u=l=="top"?e.scrollTop:l=="left"?e.scrollLeft:0,d=i-u,p=performance.now();function f(){const b=performance.now()-p,s=_(b,u,d,c);l=="top"?e.scrollTop=s:l=="left"&&(e.scrollLeft=s),b<c?requestAnimationFrame(f):r&&r()}function _(g,b,s,L){return g/=L/2,g<1?s/2*g*g+b:(g--,-s/2*(g*(g-2)-1)+b)}requestAnimationFrame(f)}function H(){let e=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const c=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(i==="x"?c:c&3|8).toString(16)})}function oe(e){const l={};return e.map(i=>{const{__id:c,...r}=i,u=JSON.stringify(r);if(!l[u])return l[u]=!0,i;const d=H();return{...i,__id:d}})}const{n:W}=M("long-text"),q={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"22","sco-ani-name":"longTextScrollAnimation","sco-ani-dura":"10"})}},P=t.defineComponent({name:"LongText",emits:["update:text"],props:q,directives:{css:U},setup(e,l){var b;const c="onUpdate:modelValue"in(((b=t.getCurrentInstance())==null?void 0:b.vnode.props)||{}),r=t.ref(null),u=t.ref(null),d=t.ref(null),p=t.ref(null),f=t.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"}),_=t.computed(()=>Object.assign(q.dynamicCss.default(),e.dynamicCss)),g=t.computed({get(){return f.isScroll=!0,e.text},set(s){c&&l.emit("update:text",s)}});return t.onMounted(()=>{t.watchEffect(()=>{t.nextTick(()=>{const s=r.value.clientWidth,V=d.value.offsetWidth;s>=V&&(f.isScroll=!1)})})}),()=>t.withDirectives(t.createVNode("div",{class:[W(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r},[t.createVNode("div",{class:W("_scroll"),ref:u},[t.createVNode("span",{ref:d,class:f.isScroll?"startAnimation":""},[g.value]),f.isScroll?t.createVNode("span",null,[t.createVNode("span",{class:"seizeASeat"},null),t.createVNode("span",{ref:p,class:"startAnimation"},[g.value]),t.createVNode("span",{class:"seizeASeat"},null)]):""])]),[[t.resolveDirective("css"),_.value||{}]])}}),{n:C}=M("roll-list"),E=X(t.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:U},props:G,components:{LongText:P},setup(e,l){var J;const c="onUpdate:modelValue"in(((J=t.getCurrentInstance())==null?void 0:J.vnode.props)||{}),r=t.reactive({uuid:D(C("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),u=t.ref(null),d=t.ref();let p=0,f=!1,_=null;const g={longText:"longText"},b=n=>{n.preventDefault()},s=t.computed(()=>Object.assign(G.dynamicCss.default(),e.dynamicCss)),L=t.computed(()=>{let n={};for(let o in s.value)o.includes("longText")&&(n[o.replace("longText-","")]=s.value[o]);return n}),V=t.computed(()=>e.header),j=()=>{var n;for(let o=0;o<((n=d.value)==null?void 0:n.children.length);o++){const a=d.value.children[o],{attractShowCount:m,header:y,tmp_scaleRule:T}=e;if(m.includes(o))if(s.value["tr-focus-bg-color-style"]=="double"){const v=s.value["tr-focus-bg-color-angle"],S=s.value["tr-focus-bg-color-from"],x=s.value["tr-focus-bg-color-to"];a.style.background=`linear-gradient(${v}deg,${S},${x})`}else a.style.background=s.value["tr-focus-bg-color-value"];else a.style.background=s.value["tr-un-focus-bg-color"];Array.from(a.children).forEach((w,v)=>{w.style.flexBasis=y[v].basis+"%",m.includes(o)?w.style.transform=`scale(${T[0]})`:w.style.transform=`scale(${T[1]})`})}},N=()=>{if(r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),e.rollType==B.AUTHROLL){if(f)return;r.rotationTimer=k.value.length>e.showCount&&setInterval(()=>{t.nextTick(()=>{re()})},e.loopTime)}},k=t.computed({get(){const n=e.modelValue.map((o,a)=>(o.__id=H(),o.__uniqueness=H(),o));return _=new ee(R(n),e.showCount*2),t.nextTick(()=>{j()}),n},set(n){c&&l.emit("update:modelValue",n)}}),ne=t.computed(()=>{if(r.takeFlag=!r.takeFlag,e.modelValue.length>e.showCount){const n=r.getInventedListDataBridgeInit?e.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return oe(_.take(n))}else return new Array(e.modelValue.length).fill(0).map((n,o)=>k.value[o])}),le=t.computed(()=>{let n=k.value.length;const o=Number(e.itemHeight.replace("px","")),a=n<=e.showCount?n:e.showCount;return o*a+"px"});t.onMounted(()=>{N(),t.watch(()=>e.rollType,()=>N()),t.watch(()=>e.loopTime,()=>N()),t.watch(()=>k.value,()=>{N()})}),t.onUnmounted(()=>{});const re=()=>{var m;const n=u==null?void 0:u.value,o=e.rollCount<=e.showCount?e.rollCount:e.showCount,a=n.scrollHeight-n.clientHeight;p=p+a/e.showCount*o;for(let y=0;y<((m=d.value)==null?void 0:m.children.length);y++){const T=d.value.children[y],{attractShowCount:F,header:w,tmp_scaleRule:v}=e,S=F.map(x=>x+o).includes(y);if(S)if(s.value["tr-focus-bg-color-style"]=="double"){const A=s.value["tr-focus-bg-color-angle"],$=s.value["tr-focus-bg-color-from"],I=s.value["tr-focus-bg-color-to"];T.style.background=`linear-gradient(${A}deg,${$},${I})`}else T.style.background=s.value["tr-focus-bg-color-value"];else T.style.background=s.value["tr-un-focus-bg-color"];Array.from(T.children).forEach((x,A)=>{x.style.flexBasis=w[A].basis+"%",S?x.style.transform=`scale(${v[0]})`:x.style.transform=`scale(${v[1]})`})}te(n,"top",p,e.scrollTransition,()=>{r.takeFlag=!r.takeFlag,n.scrollTop=0,p=0,t.nextTick(()=>{j()})})},z=()=>{f=!0,r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null)},se=()=>{f=!1,N()},ie=function(n){l.emit&&l.emit("rowClick",n)};t.onUnmounted(()=>{z(),r.rotationTimer=null});const ce=()=>{if(!s.value["pin-bg-color-style"])return"";let n="none";if(s.value["pin-bg-color-style"]=="double"){const a=s.value["pin-bg-color-angle"],m=s.value["pin-bg-color-from"],y=s.value["pin-bg-color-to"];n=`linear-gradient(${a}deg,${m},${y})`}else n=s.value["pin-bg-color-value"];return t.createVNode("div",{class:C("_pinSth"),style:{background:n}},null)},ae=()=>e.showHeader?t.createVNode("div",{class:C("_th")},[V.value.map(n=>t.createVNode("div",{class:C("_td"),style:{flexBasis:n.basis+"%"}},[n.label]))]):"",ue=()=>t.createVNode("div",{ref:u,onWheel:b,class:C("_scroll"),style:{height:le.value}},[t.createVNode("ul",{ref:d,class:C("_wrapper")},[ne.value.map(n=>de(n))])]),de=n=>t.createVNode("li",{key:n.__id,style:{height:e.itemHeight},onClick:ie.bind(this,n)},[e.header.map((o,a)=>fe(n,o,a))]),fe=(n,o,a)=>{var y,T,F,w,v,S,x,A,$,I,K,Q;let m={};return o.longText&&((y=o==null?void 0:o.longText)!=null&&y.speed&&(m["sco-ani-dura"]=o.longText.speed),(T=o.longText)!=null&&T.GPUSpee&&(m["sco-ani-name"]=((F=o==null?void 0:o.longText)==null?void 0:F.GPUSpee)==!0?"longTextScrollxAnimation3d":"longTextScrollxAnimation"),((w=o.longText)!=null&&w.txtGap||Number(o.longText.txtGap)==0)&&(m["txt-gap"]=o.longText.txtGap)),t.createVNode("div",{class:[C("_td")]},[t.createVNode("div",{class:[g[(v=V.value[a])==null?void 0:v.type]],style:{color:n[o.prop]?(S=o.fo)==null?void 0:S.color:"none",fontSize:n[o.prop]?((x=o.fo)==null?void 0:x.size)+"px":"auto",fontWeight:n[o.prop]?(A=o.fo)==null?void 0:A.weight:"0",fontFamily:n[o.prop]?($=o.fo)==null?void 0:$.style:"none"}},[(I=V.value[a])!=null&&I.type&&((K=V.value[a])==null?void 0:K.type)=="longText"?t.createVNode(P,{style:{padding:"0 1px"},text:n[o.prop]||"undefined",speed:n[o.prop]?(Q=o.longText)==null?void 0:Q.speed:!1,dynamicCss:Object.assign(R(L.value),m)},null):n[o.prop]||"undefined"])])};return()=>t.withDirectives(t.createVNode("div",{class:C(),onMouseenter:z,onMouseleave:se},[ce(),ae(),ue()]),[[t.resolveDirective("css"),s.value||{}]])}}),"roll-list");h.RollList=E,h.default=E,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
