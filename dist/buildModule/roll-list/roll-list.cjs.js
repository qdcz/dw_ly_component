"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),re=(e,l)=>(e.install=function(i){if(e){const c=e.name||e.__name;if(c||l){const r=l?`dw-${l}`:"dw-"+c.replace(/dw/gi,"").toLowerCase();i.component(r,e)}else console.error(e,l,!l)}},e),se=e=>Array.isArray(e);function B(e){const l=`vi-${e}`;return{n:r=>r?r.startsWith("-")?`${l}${r}`:`${l}_${r}`:l,classes:(...r)=>r.map(u=>{if(se(u)){const[d,p,g=null]=u;return d?p:g}return u})}}var R=(e=>(e.AUTHROLL="autoRoll",e.HANDMOVE="handRoll",e))(R||{});const q={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:8},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[3,4]},rollType:{type:String,default:"autoRoll",validator:function(e){return Object.values(R).includes(e)}},loopTime:{type:Number,default:1e3*2},scrollTransition:{type:Number,default:1e3*.8},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-wid":"800","pin-hei":"80","pin-radius":"4","pin-dire-b":"120","pin-bg-color-style":"double","pin-bg-color-to":"#00DEFF","pin-bg-color-from":"#FFFFFF","pin-bg-color-angle":"135","pin-bg-color-value":"#49a3cb","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-focus-bg-color-style":"single","tr-focus-bg-color-to":"#00DEFF","tr-focus-bg-color-from":"#FFFFFF","tr-focus-bg-color-angle":"135","tr-focus-bg-color-value":"rgb(211, 228, 242)","tr-un-focus-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","longText-txt-gap":"30","longText-sco-ani-name":"longTextScrollAnimation","longText-sco-ani-dura":"15"})}},P=function(e,l){for(let[i,c]of Object.entries(l.value))e.style.setProperty("--"+i,c)},J={mounted(e,l){P(e,l)},updated(e,l){P(e,l)},install(e){e.directive("Css",this)}},{n:ie}=B(""),ce=(e=ie())=>e+"xxxxxxxx".replace(/[xy]/g,function(l){var i=0|16*Math.random(),c=l=="x"?i:8|3&i;return c.toString(16)});class ae{constructor(l=[],i=7){this.list=l,this.severalGroups=i,this.windowSliding=new Array(this.severalGroups).fill(0).map((c,r)=>r)}take(l){return this.Sliding(l),this.show()}show(){return this.windowSliding.map(l=>this.list[l])}Sliding(l){this.windowSliding=this.windowSliding.map(i=>{const c=this.list.length,r=i+l;return r<=c-1?r:r-c})}}const I=function(e){const l=e instanceof Array?[]:{};for(let i in e)l[i]=typeof e[i]=="object"?I(e[i]):e[i];return l};function ue(e,l="top",i,c,r){const u=l=="top"?e.scrollTop:l=="left"?e.scrollLeft:0,d=i-u,p=performance.now();function g(){const x=performance.now()-p,s=S(x,u,d,c);l=="top"?e.scrollTop=s:l=="left"&&(e.scrollLeft=s),x<c?requestAnimationFrame(g):r&&r()}function S(f,x,s,F){return f/=F/2,f<1?s/2*f*f+x:(f--,-s/2*(f*(f-2)-1)+x)}requestAnimationFrame(g)}function M(){let e=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const c=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(i==="x"?c:c&3|8).toString(16)})}function de(e){const l={};return e.map(i=>{const{__id:c,...r}=i,u=JSON.stringify(r);if(!l[u])return l[u]=!0,i;const d=M();return{...i,__id:d}})}const{n:E}=B("long-text"),j={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"22","sco-ani-name":"longTextScrollAnimation","sco-ani-dura":"10"})}},z=t.defineComponent({name:"LongText",emits:["update:text"],props:j,directives:{css:J},setup(e,l){var x;const c="onUpdate:modelValue"in(((x=t.getCurrentInstance())==null?void 0:x.vnode.props)||{}),r=t.ref(null),u=t.ref(null),d=t.ref(null),p=t.ref(null),g=t.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"}),S=t.computed(()=>Object.assign(j.dynamicCss.default(),e.dynamicCss)),f=t.computed({get(){return g.isScroll=!0,e.text},set(s){c&&l.emit("update:text",s)}});return t.onMounted(()=>{t.watchEffect(()=>{t.nextTick(()=>{const s=r.value.clientWidth,_=d.value.offsetWidth;s>=_&&(g.isScroll=!1)})})}),()=>t.withDirectives(t.createVNode("div",{class:[E(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r},[t.createVNode("div",{class:E("_scroll"),ref:u},[t.createVNode("span",{ref:d,class:g.isScroll?"startAnimation":""},[f.value]),g.isScroll?t.createVNode("span",null,[t.createVNode("span",{class:"seizeASeat"},null),t.createVNode("span",{ref:p,class:"startAnimation"},[f.value]),t.createVNode("span",{class:"seizeASeat"},null)]):""])]),[[t.resolveDirective("css"),S.value||{}]])}}),{n:w}=B("roll-list"),ge=t.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:J},props:q,components:{LongText:z},setup(e,l){var O;const c="onUpdate:modelValue"in(((O=t.getCurrentInstance())==null?void 0:O.vnode.props)||{}),r=t.reactive({uuid:ce(w("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),u=t.ref(null),d=t.ref();let p=0,g=!1,S=null;const f={longText:"longText"},x=n=>{n.preventDefault()},s=t.computed(()=>Object.assign(q.dynamicCss.default(),e.dynamicCss)),F=t.computed(()=>{let n={};for(let o in s.value)o.includes("longText")&&(n[o.replace("longText-","")]=s.value[o]);return n}),_=t.computed(()=>e.header),H=()=>{var n;for(let o=0;o<((n=d.value)==null?void 0:n.children.length);o++){const a=d.value.children[o],{attractShowCount:m,header:v,tmp_scaleRule:h}=e;if(m.includes(o))if(s.value["tr-focus-bg-color-style"]=="double"){const T=s.value["tr-focus-bg-color-angle"],C=s.value["tr-focus-bg-color-from"],y=s.value["tr-focus-bg-color-to"];a.style.background=`linear-gradient(${T}deg,${C},${y})`}else a.style.background=s.value["tr-focus-bg-color-value"];else a.style.background=s.value["tr-un-focus-bg-color"];Array.from(a.children).forEach((b,T)=>{b.style.flexBasis=v[T].basis+"%",m.includes(o)?b.style.transform=`scale(${h[0]})`:b.style.transform=`scale(${h[1]})`})}},A=()=>{if(r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),e.rollType==R.AUTHROLL){if(g)return;r.rotationTimer=k.value.length>e.showCount&&setInterval(()=>{t.nextTick(()=>{Y()})},e.loopTime)}},k=t.computed({get(){const n=e.modelValue.map((o,a)=>(o.__id=M(),o.__uniqueness=M(),o));return S=new ae(I(n),e.showCount*2),t.nextTick(()=>{H()}),n},set(n){c&&l.emit("update:modelValue",n)}}),Q=t.computed(()=>{if(r.takeFlag=!r.takeFlag,e.modelValue.length>e.showCount){const n=r.getInventedListDataBridgeInit?e.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return de(S.take(n))}else return new Array(e.modelValue.length).fill(0).map((n,o)=>k.value[o])}),X=t.computed(()=>{let n=k.value.length;const o=Number(e.itemHeight.replace("px","")),a=n<=e.showCount?n:e.showCount;return o*a+"px"});t.onMounted(()=>{A(),t.watch(()=>e.rollType,()=>A()),t.watch(()=>e.loopTime,()=>A()),t.watch(()=>k.value,()=>{A()})}),t.onUnmounted(()=>{});const Y=()=>{var m;const n=u==null?void 0:u.value,o=e.rollCount<=e.showCount?e.rollCount:e.showCount,a=n.scrollHeight-n.clientHeight;p=p+a/e.showCount*o;for(let v=0;v<((m=d.value)==null?void 0:m.children.length);v++){const h=d.value.children[v],{attractShowCount:N,header:b,tmp_scaleRule:T}=e,C=N.map(y=>y+o).includes(v);if(C)if(s.value["tr-focus-bg-color-style"]=="double"){const V=s.value["tr-focus-bg-color-angle"],L=s.value["tr-focus-bg-color-from"],$=s.value["tr-focus-bg-color-to"];h.style.background=`linear-gradient(${V}deg,${L},${$})`}else h.style.background=s.value["tr-focus-bg-color-value"];else h.style.background=s.value["tr-un-focus-bg-color"];Array.from(h.children).forEach((y,V)=>{y.style.flexBasis=b[V].basis+"%",C?y.style.transform=`scale(${T[0]})`:y.style.transform=`scale(${T[1]})`})}ue(n,"top",p,e.scrollTransition,()=>{r.takeFlag=!r.takeFlag,n.scrollTop=0,p=0,t.nextTick(()=>{H()})})},G=()=>{g=!0,r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null)},Z=()=>{g=!1,A()},D=function(n){l.emit&&l.emit("rowClick",n)};t.onUnmounted(()=>{G(),r.rotationTimer=null});const ee=()=>{if(!s.value["pin-bg-color-style"])return"";let n="none";if(s.value["pin-bg-color-style"]=="double"){const a=s.value["pin-bg-color-angle"],m=s.value["pin-bg-color-from"],v=s.value["pin-bg-color-to"];n=`linear-gradient(${a}deg,${m},${v})`}else n=s.value["pin-bg-color-value"];return t.createVNode("div",{class:w("_pinSth"),style:{background:n}},null)},te=()=>e.showHeader?t.createVNode("div",{class:w("_th")},[_.value.map(n=>t.createVNode("div",{class:w("_td"),style:{flexBasis:n.basis+"%"}},[n.label]))]):"",oe=()=>t.createVNode("div",{ref:u,onWheel:x,class:w("_scroll"),style:{height:X.value}},[t.createVNode("ul",{ref:d,class:w("_wrapper")},[Q.value.map(n=>ne(n))])]),ne=n=>t.createVNode("li",{key:n.__id,style:{height:e.itemHeight},onClick:D.bind(this,n)},[e.header.map((o,a)=>le(n,o,a))]),le=(n,o,a)=>{var v,h,N,b,T,C,y,V,L,$,U,W;let m={};return o.longText&&((v=o==null?void 0:o.longText)!=null&&v.speed&&(m["sco-ani-dura"]=o.longText.speed),(h=o.longText)!=null&&h.GPUSpee&&(m["sco-ani-name"]=((N=o==null?void 0:o.longText)==null?void 0:N.GPUSpee)==!0?"longTextScrollxAnimation3d":"longTextScrollxAnimation"),((b=o.longText)!=null&&b.txtGap||Number(o.longText.txtGap)==0)&&(m["txt-gap"]=o.longText.txtGap)),t.createVNode("div",{class:[w("_td")]},[t.createVNode("div",{class:[f[(T=_.value[a])==null?void 0:T.type]],style:{color:n[o.prop]?(C=o.fo)==null?void 0:C.color:"none",fontSize:n[o.prop]?((y=o.fo)==null?void 0:y.size)+"px":"auto",fontWeight:n[o.prop]?(V=o.fo)==null?void 0:V.weight:"0",fontFamily:n[o.prop]?(L=o.fo)==null?void 0:L.style:"none"}},[($=_.value[a])!=null&&$.type&&((U=_.value[a])==null?void 0:U.type)=="longText"?t.createVNode(z,{style:{padding:"0 1px"},text:n[o.prop]||"undefined",speed:n[o.prop]?(W=o.longText)==null?void 0:W.speed:!1,dynamicCss:Object.assign(I(F.value),m)},null):n[o.prop]||"undefined"])])};return()=>t.withDirectives(t.createVNode("div",{class:w(),onMouseenter:G,onMouseleave:Z},[ee(),te(),oe()]),[[t.resolveDirective("css"),s.value||{}]])}}),K=re(ge,"roll-list");exports.RollList=K;exports.default=K;
