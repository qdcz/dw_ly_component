"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),fe=(e,n)=>(e.install=function(i){if(e){const c=e.name||e.__name;if(c||n){const r=n?`dw-${n}`:"dw-"+c.replace(/dw/gi,"").toLowerCase();i.component(r,e)}else console.error(e,n,!n)}},e),ge=e=>Array.isArray(e);function B(e){const n=`vi-${e}`;return{n:r=>r?r.startsWith("-")?`${n}${r}`:`${n}_${r}`:n,classes:(...r)=>r.map(u=>{if(ge(u)){const[f,v,g=null]=u;return f?v:g}return u})}}var R=(e=>(e.AUTHROLL="autoRoll",e.HANDMOVE="handRoll",e))(R||{});const Q={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:8},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[3,4]},rollType:{type:String,default:"autoRoll",validator:function(e){return Object.values(R).includes(e)}},loopTime:{type:Number,default:1e3*2},scrollTransition:{type:Number,default:1e3*.8},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-wid":"800","pin-hei":"80","pin-radius":"4","pin-dire-b":"120","pin-bg-color-style":"double","pin-bg-color-to":"#00DEFF","pin-bg-color-from":"#FFFFFF","pin-bg-color-angle":"135","pin-bg-color-value":"#49a3cb","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-focus-bg-color-style":"single","tr-focus-bg-color-to":"#00DEFF","tr-focus-bg-color-from":"#FFFFFF","tr-focus-bg-color-angle":"135","tr-focus-bg-color-value":"rgb(211, 228, 242)","tr-un-focus-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","td-txt-align":"center","longText-txt-gap":"30","longText-sco-ani-name":"longTextScrollAnimation","longText-sco-ani-dura":"15"})}},X=function(e,n){for(let[i,c]of Object.entries(n.value))e.style.setProperty("--"+i,c)},ee={mounted(e,n){X(e,n)},updated(e,n){X(e,n)},install(e){e.directive("Css",this)}},{n:me}=B(""),pe=(e=me())=>e+"xxxxxxxx".replace(/[xy]/g,function(n){var i=0|16*Math.random(),c=n=="x"?i:8|3&i;return c.toString(16)});class ve{constructor(n=[],i=7){this.list=n,this.severalGroups=i,this.windowSliding=new Array(this.severalGroups).fill(0).map((c,r)=>r)}take(n){return this.Sliding(n),this.show()}show(){return this.windowSliding.map(n=>this.list[n])}Sliding(n){this.windowSliding=this.windowSliding.map(i=>{const c=this.list.length,r=i+n;return r<=c-1?r:r-c})}}const I=function(e){const n=e instanceof Array?[]:{};for(let i in e)n[i]=typeof e[i]=="object"?I(e[i]):e[i];return n};function xe(e,n="top",i,c,r){const u=n=="top"?e.scrollTop:n=="left"?e.scrollLeft:0,f=i-u,v=performance.now();function g(){const y=performance.now()-v,s=S(y,u,f,c);n=="top"?e.scrollTop=s:n=="left"&&(e.scrollLeft=s),y<c?requestAnimationFrame(g):r&&r()}function S(m,y,s,F){return m/=F/2,m<1?s/2*m*m+y:(m--,-s/2*(m*(m-2)-1)+y)}requestAnimationFrame(g)}function M(){let e=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const c=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(i==="x"?c:c&3|8).toString(16)})}function ye(e){const n={};return e.map(i=>{const{__id:c,...r}=i,u=JSON.stringify(r);if(!n[u])return n[u]=!0,i;const f=M();return{...i,__id:f}})}const{n:Y}=B("long-text"),Z={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"22","sco-ani-name":"longTextScrollAnimation","sco-ani-dura":"10"})}},D=t.defineComponent({name:"LongText",emits:["update:text"],props:Z,directives:{css:ee},setup(e,n){var y;const c="onUpdate:modelValue"in(((y=t.getCurrentInstance())==null?void 0:y.vnode.props)||{}),r=t.ref(null),u=t.ref(null),f=t.ref(null),v=t.ref(null),g=t.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"}),S=t.computed(()=>Object.assign(Z.dynamicCss.default(),e.dynamicCss)),m=t.computed({get(){return g.isScroll=!0,e.text},set(s){c&&n.emit("update:text",s)}});return t.onMounted(()=>{t.watchEffect(()=>{t.nextTick(()=>{const s=r.value.clientWidth,_=f.value.offsetWidth;s>=_&&(g.isScroll=!1)})})}),()=>t.withDirectives(t.createVNode("div",{class:[Y(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r},[t.createVNode("div",{class:Y("_scroll"),ref:u},[t.createVNode("span",{ref:f,class:g.isScroll?"startAnimation":""},[m.value]),g.isScroll?t.createVNode("span",null,[t.createVNode("span",{class:"seizeASeat"},null),t.createVNode("span",{ref:v,class:"startAnimation"},[m.value]),t.createVNode("span",{class:"seizeASeat"},null)]):""])]),[[t.resolveDirective("css"),S.value||{}]])}}),{n:w}=B("roll-list"),he=t.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:ee},props:Q,components:{LongText:D},setup(e,n){var O;const c="onUpdate:modelValue"in(((O=t.getCurrentInstance())==null?void 0:O.vnode.props)||{}),r=t.reactive({uuid:pe(w("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),u=t.ref(null),f=t.ref();let v=0,g=!1,S=null;const m={longText:"longText"},y=l=>{l.preventDefault()},s=t.computed(()=>Object.assign(Q.dynamicCss.default(),e.dynamicCss)),F=t.computed(()=>{let l={};for(let o in s.value)o.includes("longText")&&(l[o.replace("longText-","")]=s.value[o]);return l}),_=t.computed(()=>e.header),H=()=>{var l;for(let o=0;o<((l=f.value)==null?void 0:l.children.length);o++){const a=f.value.children[o],{attractShowCount:p,header:d,tmp_scaleRule:h}=e;if(p.includes(o))if(s.value["tr-focus-bg-color-style"]=="double"){const T=s.value["tr-focus-bg-color-angle"],C=s.value["tr-focus-bg-color-from"],x=s.value["tr-focus-bg-color-to"];a.style.background=`linear-gradient(${T}deg,${C},${x})`}else a.style.background=s.value["tr-focus-bg-color-value"];else a.style.background=s.value["tr-un-focus-bg-color"];Array.from(a.children).forEach((b,T)=>{b.style.flexBasis=d[T].basis+"%",p.includes(o)?b.style.transform=`scale(${h[0]})`:b.style.transform=`scale(${h[1]})`})}},V=()=>{if(r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),e.rollType==R.AUTHROLL){if(g)return;r.rotationTimer=k.value.length>e.showCount&&setInterval(()=>{t.nextTick(()=>{le()})},e.loopTime)}},k=t.computed({get(){const l=e.modelValue.map((o,a)=>(o.__id=M(),o.__uniqueness=M(),o));return S=new ve(I(l),e.showCount*2),t.nextTick(()=>{H()}),l},set(l){c&&n.emit("update:modelValue",l)}}),oe=t.computed(()=>{if(r.takeFlag=!r.takeFlag,e.modelValue.length>e.showCount){const l=r.getInventedListDataBridgeInit?e.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return ye(S.take(l))}else return new Array(e.modelValue.length).fill(0).map((l,o)=>k.value[o])}),ne=t.computed(()=>{let l=k.value.length;const o=Number(e.itemHeight.replace("px","")),a=l<=e.showCount?l:e.showCount;return o*a+"px"});t.onMounted(()=>{V(),t.watch(()=>e.rollType,()=>V()),t.watch(()=>e.loopTime,()=>V()),t.watch(()=>k.value,()=>{V()})}),t.onUnmounted(()=>{});const le=()=>{var p;const l=u==null?void 0:u.value,o=e.rollCount<=e.showCount?e.rollCount:e.showCount,a=l.scrollHeight-l.clientHeight;v=v+a/e.showCount*o;for(let d=0;d<((p=f.value)==null?void 0:p.children.length);d++){const h=f.value.children[d],{attractShowCount:N,header:b,tmp_scaleRule:T}=e,C=N.map(x=>x+o).includes(d);if(C)if(s.value["tr-focus-bg-color-style"]=="double"){const A=s.value["tr-focus-bg-color-angle"],L=s.value["tr-focus-bg-color-from"],$=s.value["tr-focus-bg-color-to"];h.style.background=`linear-gradient(${A}deg,${L},${$})`}else h.style.background=s.value["tr-focus-bg-color-value"];else h.style.background=s.value["tr-un-focus-bg-color"];Array.from(h.children).forEach((x,A)=>{x.style.flexBasis=b[A].basis+"%",C?x.style.transform=`scale(${T[0]})`:x.style.transform=`scale(${T[1]})`})}xe(l,"top",v,e.scrollTransition,()=>{r.takeFlag=!r.takeFlag,l.scrollTop=0,v=0,t.nextTick(()=>{H()})})},G=()=>{g=!0,r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null)},re=()=>{g=!1,V()},se=function(l){n.emit&&n.emit("rowClick",l)};t.onUnmounted(()=>{G(),r.rotationTimer=null});const ie=()=>{if(!s.value["pin-bg-color-style"])return"";let l="none";if(s.value["pin-bg-color-style"]=="double"){const a=s.value["pin-bg-color-angle"],p=s.value["pin-bg-color-from"],d=s.value["pin-bg-color-to"];l=`linear-gradient(${a}deg,${p},${d})`}else l=s.value["pin-bg-color-value"];return t.createVNode("div",{class:w("_pinSth"),style:{background:l}},null)},ce=()=>e.showHeader?t.createVNode("div",{class:w("_th")},[_.value.map(l=>t.createVNode("div",{class:w("_td"),style:{flexBasis:l.basis+"%"}},[l.label]))]):"",ae=()=>t.createVNode("div",{ref:u,onWheel:y,class:w("_scroll"),style:{height:ne.value}},[t.createVNode("ul",{ref:f,class:w("_wrapper")},[oe.value.map(l=>ue(l))])]),ue=l=>t.createVNode("li",{key:l.__id,style:{height:e.itemHeight},onClick:se.bind(this,l)},[e.header.map((o,a)=>de(l,o,a))]),de=(l,o,a)=>{var h,N,b,T,C,x,A,L,$,U,W,q,P,E,z,j,J,K;let p={};o.longText&&((h=o==null?void 0:o.longText)!=null&&h.speed&&(p["sco-ani-dura"]=o.longText.speed),(N=o.longText)!=null&&N.GPUSpee&&(p["sco-ani-name"]=((b=o==null?void 0:o.longText)==null?void 0:b.GPUSpee)==!0?"longTextScrollxAnimation3d":"longTextScrollxAnimation"),((T=o.longText)!=null&&T.txtGap||Number(o.longText.txtGap)==0)&&(p["txt-gap"]=o.longText.txtGap));const d={};return l[o.prop]&&((C=o.fo)!=null&&C.textAlign&&(d.textAlign=(x=o.fo)==null?void 0:x.textAlign),(A=o.fo)!=null&&A.style&&(d.fontFamily=(L=o.fo)==null?void 0:L.style),($=o.fo)!=null&&$.weight&&(d.fontWeight=(U=o.fo)==null?void 0:U.weight),(W=o.fo)!=null&&W.color&&(d.color=(q=o.fo)==null?void 0:q.color),(P=o.fo)!=null&&P.size&&(d.fontSize=((E=o.fo)==null?void 0:E.size)+"px")),t.createVNode("div",{class:[w("_td")]},[t.createVNode("div",{class:[m[(z=_.value[a])==null?void 0:z.type]],style:{...d}},[(j=_.value[a])!=null&&j.type&&((J=_.value[a])==null?void 0:J.type)=="longText"?t.createVNode(D,{style:{padding:"0 1px"},text:l[o.prop]||"undefined",speed:l[o.prop]?(K=o.longText)==null?void 0:K.speed:!1,dynamicCss:Object.assign(I(F.value),p)},null):l[o.prop]||"undefined"])])};return()=>t.withDirectives(t.createVNode("div",{class:w(),onMouseenter:G,onMouseleave:re},[ie(),ce(),ae()]),[[t.resolveDirective("css"),s.value||{}]])}}),te=fe(he,"roll-list");exports.RollList=te;exports.default=te;
