"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),X=(e,n)=>(e.install=function(s){if(e){const i=e.name||e.__name;if(i||n){const r=n?`dw-${n}`:"dw-"+i.replace(/dw/gi,"").toLowerCase();s.component(r,e)}else console.error(e,n,!n)}},e),Y=e=>Array.isArray(e);function U(e){const n=`vi-${e}`;return{n:r=>r?r.startsWith("-")?`${n}${r}`:`${n}_${r}`:n,classes:(...r)=>r.map(c=>{if(Y(c)){const[u,h,d=null]=c;return u?h:d}return c})}}const O={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:6},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[1,3,4]},loopTime:{type:Number,default:1e3*3},scrollTransition:{type:Number,default:1e3*2},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},dynamicCss:{type:Object,default:()=>({"box-width":"800","th-pad-tb":"10","th-bg-color":"rgb(179, 210, 224)","th-fo-color":"rgb(90, 99, 110)","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-hover-bg-color":"rgb(132 176 212 / 80%)","tr-hover-transition":"0.3","tr-attract-bg-color-style":"single","tr-attract-bg-color-to":"#00DEFF","tr-attract-bg-color-from":"#FFFFFF","tr-attract-bg-color-angle":"135","tr-attract-bg-color-value":"rgb(211, 228, 242)","tr-un-attract-bg-color":"rgb(235, 235, 235)","td-pad-lr":"20","td-pad-tb":"0","longText-txt-gap":"30"})}},R=function(e,n){for(let[s,i]of Object.entries(n.value))e.style.setProperty("--"+s,i)},J={mounted(e,n){R(e,n)},updated(e,n){R(e,n)},install(e){e.directive("Css",this)}},{n:Z}=U(""),D=(e=Z())=>e+"xxxxxxxx".replace(/[xy]/g,function(n){var s=0|16*Math.random(),i=n=="x"?s:8|3&s;return i.toString(16)});class ee{constructor(n=[],s=7){this.list=n,this.severalGroups=s,this.windowSliding=new Array(this.severalGroups).fill(0).map((i,r)=>r)}take(n){return this.Sliding(n),this.show()}show(){return this.windowSliding.map(n=>this.list[n])}Sliding(n){this.windowSliding=this.windowSliding.map(s=>{const i=this.list.length,r=s+n;return r<=i-1?r:r-i})}}const K=function(e){const n=e instanceof Array?[]:{};for(let s in e)n[s]=typeof e[s]=="object"?K(e[s]):e[s];return n};function te(e,n="top",s,i,r){const c=n=="top"?e.scrollTop:n=="left"?e.scrollLeft:0,u=s-c,h=performance.now();function d(){const a=performance.now()-h,w=b(a,c,u,i);n=="top"?e.scrollTop=w:n=="left"&&(e.scrollLeft=w),a<i?requestAnimationFrame(d):r&&r()}function b(m,a,w,T){return m/=T/2,m<1?w/2*m*m+a:(m--,-w/2*(m*(m-2)-1)+a)}requestAnimationFrame(d)}function ne(){let e=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(s==="x"?i:i&3|8).toString(16)})}function oe(e){const n={};return e.map(s=>{const{__id:i,...r}=s,c=JSON.stringify(r);if(!n[c])return n[c]=!0,s;const u=ne();return{...s,__id:u}})}const{n:z}=U("long-text"),j={text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3},dynamicCss:{type:Object,default:()=>({"txt-gap":"20"})}},G=t.defineComponent({name:"LongText",emits:["update:text"],props:j,directives:{css:J},setup(e,n){var W;const i="onUpdate:modelValue"in(((W=t.getCurrentInstance())==null?void 0:W.vnode.props)||{}),r=t.ref(null),c=t.ref(null),u=t.ref(null),h=t.ref(null);let d=null;const b=t.reactive({isScroll:!0,toolTip_x:0,toolTip_y:0,toolTip_content:"盎司附近拉萨解放了卡JFK垃圾地方"});let m=0;const a=t.computed(()=>Object.assign(j.dynamicCss.default(),e.dynamicCss)),w=t.computed({get(){return b.isScroll=!0,M(b),e.text},set(y){i&&n.emit("update:text",y)}}),T=()=>{var S,q,$;const y=(S=u==null?void 0:u.value)==null?void 0:S.offsetWidth,L=(q=h==null?void 0:h.value)==null?void 0:q.offsetWidth,k=($=c==null?void 0:c.value)==null?void 0:$.scrollLeft,F=performance.now();m||(m=F);const I=F-m;y/e.speed*I,L-k<=0?(c.value.scrollLeft-=u.value.offsetWidth,m=0,requestAnimationFrame(T)):c.value&&c.value.scrollLeft++},M=y=>{t.nextTick(()=>{if(r.value&&u.value){const L=r.value.clientWidth,k=u.value.offsetWidth,F=Number(a.value["txt-gap"]),I=k-F;if(L<I){_();const S=()=>{T(),d=requestAnimationFrame(S)};d=requestAnimationFrame(S)}else y&&(y.isScroll=!1)}})},_=()=>d?(cancelAnimationFrame(d),d=null,!0):!1,E=y=>{b.toolTip_x=y.x,b.toolTip_y=y.y,_()},H=()=>{M()};return t.onUnmounted(()=>{d&&(clearInterval(d),d=null)}),()=>t.withDirectives(t.createVNode("div",{class:[z(""),"tooltip"],"data-tooltip":"这是一个 tooltip",ref:r,onMouseenter:E,onMouseleave:H},[t.createVNode("div",{class:z("_scroll"),ref:c},[t.createVNode("span",{ref:u},[w.value,b.isScroll?t.createVNode("span",{class:"seizeASeat"},null):""]),t.createVNode("span",{ref:h},[b.isScroll?w.value:"",b.isScroll?t.createVNode("span",{class:"seizeASeat"},null):""])])]),[[t.resolveDirective("css"),a.value||{}]])}}),{n:A}=U("roll-list"),re=t.defineComponent({name:"RollList",emits:["update:modelValue","rowClick"],directives:{css:J},props:O,components:{LongText:G},setup(e,n){var $;const i="onUpdate:modelValue"in((($=t.getCurrentInstance())==null?void 0:$.vnode.props)||{}),r=t.reactive({uuid:D(A("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),c=t.ref(null),u=t.ref();let h=0,d=null;const b={longText:"longText"},m=o=>{o.preventDefault()},a=t.computed(()=>Object.assign(O.dynamicCss.default(),e.dynamicCss)),w=t.computed(()=>{let o={};for(let l in a.value)l.includes("longText")&&(o[l.replace("longText-","")]=a.value[l]);return o}),T=t.computed(()=>e.header),M=()=>{var o;for(let l=0;l<((o=u.value)==null?void 0:o.children.length);l++){const g=u.value.children[l],{attractShowCount:V,header:v,tmp_scaleRule:f}=e;V.includes(l)?(a.value["tr-attract-bg-color-style"]=="double"?g.style.background=`linear-gradient(${a.value["tr-attract-bg-color-angle"]}deg,${a.value["tr-attract-bg-color-from"]},${a.value["tr-attract-bg-color-to"]})`:g.style.background=a.value["tr-attract-bg-color-value"],Array.from(g.children).forEach((p,C)=>{p.style.transform=`scale(${f[0]})`,p.style.flexBasis=v[C].basis+"%"})):(g.style.background=a.value["tr-un-attract-bg-color"],Array.from(g.children).forEach((p,C)=>{p.style.transform=`scale(${f[1]})`,p.style.flexBasis=v[C].basis+"%"}))}},_=t.computed({get(){return d=new ee(K(e.modelValue),e.showCount*2),t.nextTick(()=>{M()}),e.modelValue},set(o){i&&n.emit("update:modelValue",o)}}),E=t.computed(()=>{if(r.takeFlag=!r.takeFlag,e.modelValue.length>e.showCount){const o=r.getInventedListDataBridgeInit?e.rollCount:(r.getInventedListDataBridgeInit=!0)&&0;return oe(d.take(o))}else return new Array(e.modelValue.length).fill(0).map((o,l)=>_.value[l])}),H=t.computed(()=>{let o=_.value.length;const l=Number(e.itemHeight.replace("px","")),g=o<=e.showCount?o:e.showCount;return l*g+"px"});t.onMounted(()=>{t.watchEffect(()=>{r.rotationTimer&&(clearInterval(r.rotationTimer),r.rotationTimer=null),r.rotationTimer=_.value.length>e.showCount&&setInterval(()=>{W()},e.loopTime)})});const W=()=>{var V;const o=c==null?void 0:c.value,l=e.rollCount<=e.showCount?e.rollCount:e.showCount,g=o.scrollHeight-o.clientHeight;h=h+g/e.showCount*l;for(let v=0;v<((V=u.value)==null?void 0:V.children.length);v++){const f=u.value.children[v],{rollCount:p,attractShowCount:C,scrollTransition:N,header:B}=e;f.style.transition=`${N/1e3}s`,C.map(x=>x+p).includes(v)?(a.value["tr-attract-bg-color-style"]=="double"?f.style.background=`linear-gradient(${a.value["tr-attract-bg-color-angle"]}deg,${a.value["tr-attract-bg-color-from"]},${a.value["tr-attract-bg-color-to"]})`:f.style.background=a.value["tr-attract-bg-color-value"],Array.from(f.children).forEach((x,P)=>{x.style.transition=`${N/1e3}s`,x.style.flexBasis=B[P].basis+"%",x.style.transform=`scale(${e.tmp_scaleRule[0]})`})):(f.style.background=a.value["tr-un-attract-bg-color"],Array.from(f.children).forEach((x,P)=>{x.style.transition=`${N/1e3}s`,x.style.flexBasis=B[P].basis+"%",x.style.transform=`scale(${e.tmp_scaleRule[1]})`}))}te(o,"top",h,e.scrollTransition,()=>{var v;for(let f=0;f<((v=u.value)==null?void 0:v.children.length);f++){const p=u.value.children[f];p.style.transition="0s",Array.from(p.children).forEach(C=>{C.style.transition="0s"})}r.takeFlag=!r.takeFlag,o.scrollTop=0,h=0})},y=()=>{r.rotationTimer&&clearInterval(r.rotationTimer)},L=()=>{r.rotationTimer=null},k=function(o){n.emit&&n.emit("rowClick",o)};t.onUnmounted(()=>{y(),r.rotationTimer=null});const F=()=>e.showHeader?t.createVNode("div",{class:A("_th")},[T.value.map(o=>t.createVNode("div",{class:A("_td"),style:{flexBasis:o.basis+"%"}},[o.label]))]):"",I=()=>t.createVNode("div",{ref:c,onWheel:m,class:A("_scroll"),style:{height:H.value}},[t.createVNode("ul",{ref:u,class:A("_wrapper")},[E.value.map(o=>S(o))])]),S=o=>t.createVNode("li",{key:o.__id,style:{height:e.itemHeight},onClick:k.bind(this,o)},[e.header.map((l,g)=>q(o,l,g))]),q=(o,l,g)=>{var V,v,f,p,C,N,B,x;return t.createVNode("div",{class:[A("_td")]},[t.createVNode("div",{class:[b[(V=T.value[g])==null?void 0:V.type]],style:{color:o[l.prop]?(v=l.fo)==null?void 0:v.color:"none",fontSize:o[l.prop]?((f=l.fo)==null?void 0:f.size)+"px":"auto",fontWeight:o[l.prop]?(p=l.fo)==null?void 0:p.weight:"0",fontFamily:o[l.prop]?(C=l.fo)==null?void 0:C.style:"none"}},[(N=T.value[g])!=null&&N.type&&((B=T.value[g])==null?void 0:B.type)=="longText"?t.createVNode(G,{text:o[l.prop]||"undefined",speed:o[l.prop]?(x=l.longText)==null?void 0:x.speed:!1,dynamicCss:w.value},null):o[l.prop]||"undefined"])])};return()=>t.withDirectives(t.createVNode("div",{class:A(),onMouseenter:y,onMouseleave:L},[F(),I()]),[[t.resolveDirective("css"),a.value||{}]])}}),Q=X(re,"roll-list");exports.RollList=Q;exports.default=Q;
