"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),M=(e,r)=>(e.install=function(s){if(e){const c=e.name||e.__name;if(c||r){const l=r?`dw-${r}`:"dw-"+c.replace(/dw/gi,"").toLowerCase();s.component(l,e)}else console.error(e,r,!r)}},e),P=e=>Array.isArray(e);function L(e){const r=`vi-${e}`;return{n:l=>l?l.startsWith("-")?`${r}${l}`:`${r}_${l}`:r,classes:(...l)=>l.map(i=>{if(P(i)){const[u,b,y=null]=i;return u?b:y}return i})}}const F={header:{type:Array,default:[]},showHeader:{type:Boolean,default:!0},itemHeight:{type:[String],default:"40px"},showCount:{type:[Number],default:6},rollCount:{type:[Number],default:1},attractShowCount:{type:Array,default:[1,3,4]},loopTime:{type:Number,default:1e3*5e3},scrollTransition:{type:Number,default:1e3*2},tmp_scaleRule:{type:Array,default:[1.3,1]},scaleRule:{type:[Number,Array],default:[1.5,1,.8]},modelValue:{type:Array,default:[]},longTextSpeed:{type:Number,default:1e3/60},dynamicCss:{type:Object,default:()=>({"box-width":"800","th-pad-tb":"10","th-bg-color":"#0f2851","th-fo-color":"#df9418","th-fo-size":"16","th-fo-weight":"900","th-radius-lt":"8","th-radius-rt":"8","th-radius-lb":"0","th-radius-rb":"0","tr-attract-bg-color-style":"single","tr-attract-bg-color-to":"#00DEFF","tr-attract-bg-color-from":"#FFFFFF","tr-attract-bg-color-angle":"135","tr-attract-bg-color-value":"#184677","tr-attract-bg-color":"#184677","tr-un-attract-bg-color":"#04172c","td-pad-lr":"20","td-pad-tb":"0"})}},k=function(e,r){for(let[s,c]of Object.entries(r.value))e.style.setProperty("--"+s,c)},q={mounted(e,r){k(e,r)},updated(e,r){k(e,r)},install(e){e.directive("Css",this)}},{n:z}=L(""),O=(e=z())=>e+"xxxxxxxx".replace(/[xy]/g,function(r){var s=0|16*Math.random(),c=r=="x"?s:8|3&s;return c.toString(16)});class U{constructor(r=[],s=7){this.list=r,this.severalGroups=s,this.windowSliding=new Array(this.severalGroups).fill(0).map((c,l)=>l)}take(r){return this.Sliding(r),this.show()}show(){return this.windowSliding.map(r=>this.list[r])}Sliding(r){this.windowSliding=this.windowSliding.map(s=>{const c=this.list.length,l=s+r;return l<=c-1?l:l-c})}}const D=function(e){const r=e instanceof Array?[]:{};for(let s in e)r[s]=typeof e[s]=="object"?D(e[s]):e[s];return r};function G(e,r="top",s,c,l){const i=r=="top"?e.scrollTop:r=="left"?e.scrollLeft:0,u=s-i,b=performance.now();function y(){const n=performance.now()-b,h=C(n,i,u,c);r=="top"?e.scrollTop=h:r=="left"&&(e.scrollLeft=h),n<c?requestAnimationFrame(y):l&&l()}function C(f,n,h,x){return f/=x/2,f<1?h/2*f*f+n:(f--,-h/2*(f*(f-2)-1)+n)}requestAnimationFrame(y)}const{n:R}=L("scroll-text"),j=t.defineComponent({name:"ScrollText",emits:["update:text"],props:{text:{type:String,default:"这是一个默认文本"},speed:{type:Number,default:1e3/60}},setup(e,r){var h;const c="onUpdate:modelValue"in(((h=t.getCurrentInstance())==null?void 0:h.vnode.props)||{}),l=t.ref(null),i=t.ref(null),u=t.ref(null),b=t.ref(null);let y=null;const C=t.reactive({isScroll:!0}),f=t.computed({get(){return C.isScroll=!0,t.nextTick(()=>{if(l.value&&u.value){const x=l.value.clientWidth,N=u.value.offsetWidth-20;x<N?(y&&(clearInterval(y),y=null),y=setInterval(n,e.speed)):C.isScroll=!1}}),e.text+""},set(x){c&&r.emit("update:text",x)}}),n=()=>{b.value.offsetWidth-i.value.scrollLeft<=0?i.value.scrollLeft-=u.value.offsetWidth:i.value.scrollLeft++};return()=>t.createVNode("div",{class:R(""),ref:l},[t.createVNode("div",{class:R("_scroll"),ref:i},[t.createVNode("span",{ref:u},[f.value,C.isScroll?t.createVNode("span",{class:"seizeASeat"},null):""]),t.createVNode("span",{ref:b},[C.isScroll?f.value:"",C.isScroll?t.createVNode("span",{class:"seizeASeat"},null):""])])])}}),{n:S}=L("roll-list"),Q=t.defineComponent({name:"RollList",emits:["update:modelValue"],directives:{css:q},props:F,components:{scrollText:j},setup(e,r){var B;const c="onUpdate:modelValue"in(((B=t.getCurrentInstance())==null?void 0:B.vnode.props)||{}),l=t.reactive({uuid:O(S("-")),takeFlag:!1,rotationTimer:null,getInventedListDataBridgeInit:!1}),i=t.ref(null),u=t.ref();let b=0,y=null;const C={longText:"longText"},f=o=>{o.preventDefault()},n=t.computed(()=>Object.assign(F.dynamicCss.default(),e.dynamicCss)),h=t.computed(()=>e.header),x=()=>{var o;for(let a=0;a<((o=u.value)==null?void 0:o.children.length);a++){const g=u.value.children[a],{attractShowCount:T,header:m,tmp_scaleRule:d}=e;T.includes(a)?(n.value["tr-attract-bg-color-style"]=="double"?g.style.background=`linear-gradient(${n.value["tr-attract-bg-color-angle"]}deg,${n.value["tr-attract-bg-color-from"]},${n.value["tr-attract-bg-color-to"]})`:g.style.background=n.value["tr-attract-bg-color-value"],Array.from(g.children).forEach((v,w)=>{v.style.transform=`scale(${d[0]})`,v.style.flexBasis=m[w].basis+"%"})):(g.style.background=n.value["tr-un-attract-bg-color"],Array.from(g.children).forEach((v,w)=>{v.style.transform=`scale(${d[1]})`,v.style.flexBasis=m[w].basis+"%"}))}},N=t.computed({get(){return y=new U(D(e.modelValue),e.showCount*2),t.nextTick(()=>{x()}),e.modelValue},set(o){c&&r.emit("update:modelValue",o)}}),H=t.computed(()=>{if(l.takeFlag=!l.takeFlag,e.modelValue.length>e.showCount){const o=l.getInventedListDataBridgeInit?e.rollCount:(l.getInventedListDataBridgeInit=!0)&&0;return y.take(o)}else return new Array(e.modelValue.length).fill(0).map((o,a)=>N.value[a])}),W=t.computed(()=>{let o=N.value.length;const a=Number(e.itemHeight.replace("px","")),g=o<=e.showCount?o:e.showCount;return a*g+"px"});t.watchEffect(()=>{l.rotationTimer&&(clearInterval(l.rotationTimer),l.rotationTimer=null),l.rotationTimer=N.value.length>e.showCount&&setInterval(()=>{I()},e.loopTime)});const I=()=>{var T;const o=i==null?void 0:i.value,a=e.rollCount<=e.showCount?e.rollCount:e.showCount,g=o.scrollHeight-o.clientHeight;b=b+g/e.showCount*a;for(let m=0;m<((T=u.value)==null?void 0:T.children.length);m++){const d=u.value.children[m],{rollCount:v,attractShowCount:w,scrollTransition:V,header:$}=e;d.style.transition=`${V/1e3}s`,w.map(p=>p+v).includes(m)?(n.value["tr-attract-bg-color-style"]=="double"?d.style.background=`linear-gradient(${n.value["tr-attract-bg-color-angle"]}deg,${n.value["tr-attract-bg-color-from"]},${n.value["tr-attract-bg-color-to"]})`:d.style.background=n.value["tr-attract-bg-color-value"],Array.from(d.children).forEach((p,A)=>{p.style.transition=`${V/1e3}s`,p.style.flexBasis=$[A].basis+"%",p.style.transform=`scale(${e.tmp_scaleRule[0]})`})):(d.style.background=n.value["tr-un-attract-bg-color"],Array.from(d.children).forEach((p,A)=>{p.style.transition=`${V/1e3}s`,p.style.flexBasis=$[A].basis+"%",p.style.transform=`scale(${e.tmp_scaleRule[1]})`}))}G(o,"top",b,e.scrollTransition,()=>{var m;for(let d=0;d<((m=u.value)==null?void 0:m.children.length);d++){const v=u.value.children[d];v.style.transition="0s",Array.from(v.children).forEach(w=>{w.style.transition="0s"})}l.takeFlag=!l.takeFlag,o.scrollTop=0,b=0,x()})};t.nextTick(()=>{});const _=()=>e.showHeader?t.createVNode("div",{class:S("_th")},[h.value.map(o=>t.createVNode("div",{class:S("_td"),style:{flexBasis:o.basis+"%"}},[o.label]))]):"";return()=>t.withDirectives(t.createVNode("div",{class:S()},[_(),t.createVNode("div",{ref:i,onWheel:f,class:S("_scroll"),style:{height:W.value}},[t.createVNode("ul",{ref:u,class:S("_wrapper")},[H.value.map(o=>t.createVNode("li",{style:{height:e.itemHeight}},[e.header.map((a,g)=>{var T,m,d,v,w,V,$,p;return t.createVNode("div",{class:[S("_td")]},[t.createVNode("div",{class:[C[(T=h.value[g])==null?void 0:T.type]],style:{color:o[a.prop]?(m=a.fo)==null?void 0:m.color:"none",fontSize:o[a.prop]?((d=a.fo)==null?void 0:d.size)+"px":"auto",fontWeight:o[a.prop]?(v=a.fo)==null?void 0:v.weight:"0",fontFamily:o[a.prop]?(w=a.fo)==null?void 0:w.style:"none"}},[(V=h.value[g])!=null&&V.type&&(($=h.value[g])==null?void 0:$.type)=="longText"?t.createVNode(t.resolveComponent("scrollText"),{text:o[a.prop]||"undefined",speed:o[a.prop]?(p=a.longText)==null?void 0:p.speed:!1},null):o[a.prop]||"undefined"])])})]))])])]),[[t.resolveDirective("css"),n.value||{}]])}}),E=M(Q,"roll-list");exports.RollList=E;exports.default=E;
