"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const r=require("vue"),O=(t,s)=>(t.install=function(f){if(t){const o=t.name||t.__name;if(o||s){const d=s?`dw-${s}`:"dw-"+o.replace(/dw/gi,"").toLowerCase();f.component(d,t)}else console.error(t,s,!s)}},t),G=t=>Array.isArray(t);function T(t){const s=`vi-${t}`;return{n:d=>d?d.startsWith("-")?`${s}${d}`:`${s}_${d}`:s,classes:(...d)=>d.map(g=>{if(G(g)){const[m,i,u=null]=g;return m?i:u}return g})}}const C=function(t,s){for(let[f,o]of Object.entries(s.value))t.style.setProperty("--"+f,o)},z={mounted(t,s){C(t,s)},updated(t,s){C(t,s)},install(t){t.directive("Css",this)}},N={heightScroll:{type:Boolean,default:!1},height:{type:String,default:"500"},width:{type:String,default:"600"},backgroundImg:{type:Object,default:()=>({leftBackgroundImg:"https://cdnforspeed.oss-cn-beijing.aliyuncs.com/Img/demo%20icon/Group%201321316955.png",leftBackgroundImgActive:"https://cdnforspeed.oss-cn-beijing.aliyuncs.com/Img/demo%20icon/Group%201321316954.png",rightBackgroundImg:"https://cdnforspeed.oss-cn-beijing.aliyuncs.com/Img/demo%20icon/Group%201321316957.png",rightBackgroundImgActive:"https://cdnforspeed.oss-cn-beijing.aliyuncs.com/Img/demo%20icon/Group%201321316958.png"})},dynamicCss:{type:Object,default:()=>({"item-mar-t":"10","item-pad-tb":"2","item-color_act":"#260bd984","left-color":"#166947e4","left-fo-wei":"600","left-fo-size":"20","left-fo-fam":"monospace","left-pad-r":"30","left-pad-l":"10","right-color":"#166947e4","right-fo-weight":"600","right-fo-size":"16","right-fo-family":"monospace","right-pad-r":"2","right-pad-l":"44","left-color_hov":"#65de06ff","right-color_hov":"#fff","line-color":"#b9dffce4","line-color_act":"#fc0","line-color_hov":"#55b2f8e4","line-wid":"2","line-wid_hov":"4","line-wid_act":"4","ani-time":"2"})},modelValue:{type:Array,default:[{name:"刘一",id:Math.random()*1e7,type:"left",link:[1,5,7]},{name:"陈二",id:Math.random()*1e7,type:"left",link:[1,2,3,4,5,6,7,8,9,10,11,12,13]},{name:"张三",id:Math.random()*1e7,type:"left",link:[8,6]},{name:"李四",id:Math.random()*1e7,type:"left",link:[2,3,4]},{name:"王五",id:Math.random()*1e7,type:"left",link:[9]},{name:"赵六",id:Math.random()*1e7,type:"left",link:[10,11]},{name:"孙七",id:Math.random()*1e7,type:"left",link:[13]},{name:"周八",id:Math.random()*1e7,type:"left",link:[1,13]},{name:"吴九",id:Math.random()*1e7,type:"left",link:[5]},{name:"郑十",id:Math.random()*1e7,type:"left",link:[2]},{name:"可弹性拓展网盘",type:"right",id:1},{name:"智慧工单管理系统",type:"right",id:2},{name:"大数据中台",type:"right",id:3},{name:"ERP管理",type:"right",id:4},{name:"gis可视化系统",type:"right",id:5},{name:"矿业管理系统",type:"right",id:6},{name:"帝网集成中心",type:"right",id:7},{name:"人事档案管理中心",type:"right",id:8},{name:"营销系统3.0",type:"right",id:9},{name:"东湖小镇数字孪生",type:"right",id:10},{name:"大模型调用中心",type:"right",id:11},{name:"业务中心中台",type:"right",id:12},{name:"政务系统",type:"right",id:13}]}},{n:c}=T("sankey-diagram"),q=r.defineComponent({name:"sankeyDiagram",emits:["update:width","select"],directives:{css:z},props:N,setup(t,s){var w;const o="onUpdate:modelValue"in(((w=r.getCurrentInstance())==null?void 0:w.vnode.props)||{}),d=r.ref(null),g=r.ref(null),m=r.ref(null),i=r.reactive({activeDomsIds:[],isActive:!1,leftItemHeight:0,leftItemWidth:0,rightItemHeight:0,rightItemWidth:0,centerBoxWidth:0,linkData:[],svg_path_d:[],svg_path_ids:[]}),u=r.computed(()=>{const e=Object.assign(N.dynamicCss.default(),t.dynamicCss);return e["left-bg-image"]=`url(${t.backgroundImg.leftBackgroundImg})`,e["left-bg-image_active"]=`url(${t.backgroundImg.leftBackgroundImgActive})`,e["right-bg-image"]=`url(${t.backgroundImg.rightBackgroundImg})`,e["right-bg-image_active"]=`url(${t.backgroundImg.rightBackgroundImgActive})`,e}),p=r.computed({get(){return t.modelValue.filter(e=>e.type=="left")},set(e){o&&s.emit("update:modelValue",e)}}),$=r.computed({get(){return t.modelValue.filter(e=>e.type=="right")},set(e){o&&s.emit("update:modelValue",e)}}),D=(e="left",n,l)=>{t.modelValue.filter(a=>a.type==e).forEach((a,h)=>{let k=n,v=0,y=h*l+l/2;const I=Number(u.value["item-mar-t"]);h==0?v=y:v=y+I*h;const _=[k,v];i.linkData.push({id:a.id,position:_})})},S=()=>{let e=[],n=[];for(let l=0;l<p.value.length;l++){const a=p.value[l];if(a.link&&a.link.length>0&&i.linkData&&i.linkData.length>0)for(let h=0;h<a.link.length;h++){const k=a.link[h],v=i.linkData.filter(b=>b.id==a.id)[0],y=i.linkData.filter(b=>b.id==k)[0],I=`${0},${v.position[1]}`,_=`${y.position[0]},${y.position[1]}`,R=`M ${I} ${_}`;e.push(R),n.push(`${a.id},${k}`)}}return{list:e,ids:n}},j=()=>{r.nextTick(()=>{i.leftItemHeight=d.value.children[0].getBoundingClientRect().height,i.leftItemWidth=d.value.clientWidth,i.rightItemHeight=m.value.children[0].getBoundingClientRect().height,i.rightItemWidth=m.value.clientWidth,i.centerBoxWidth=g.value.clientWidth,D("left",i.leftItemWidth,i.leftItemHeight),D("right",i.centerBoxWidth,i.rightItemHeight);const{list:e,ids:n}=S();i.svg_path_d=e,i.svg_path_ids=n;let l=p.value.length,a=$.value.length;g.value.style.height=Math.max(i.rightItemHeight*a+u.value["item-mar-t"]*(a-1),i.leftItemHeight*l+u.value["item-mar-t"]*(l-1))+"px"})},B=()=>{const e={};return[...Array.from(d.value.children),...Array.from(g.value.children),...Array.from(m.value.children)].forEach(l=>{let a=l.getAttribute("data-id");a&&(e[a]=l)}),e};r.onMounted(()=>{j()});const E=function(e){const n=B();V(n),e.type=="left"?[...e.link,e.id].forEach(l=>{i.activeDomsIds.push(l),n[l].classList.add("active"),i.svg_path_ids.forEach(a=>{a==`${e.id},${l}`&&(i.activeDomsIds.push(a),n[a].classList.add("active"))})}):e.type=="right"&&(p.value.forEach(l=>{l.link&&l.link.length>0&&l.link.findIndex(a=>a==e.id)!=-1&&(i.activeDomsIds.push(l.id),n[l.id].classList.add("active"),i.svg_path_ids.forEach(a=>{a==`${l.id},${e.id}`&&(i.activeDomsIds.push(a),n[a].classList.add("active"))}),i.activeDomsIds.push(e.id),n[e.id].classList.add("active"))}),i.activeDomsIds.push(e.id)),s.emit&&s.emit("select",e)},V=e=>{e=e||B();let n=i.activeDomsIds.pop();for(;n;)e[n].classList.remove("active"),n=i.activeDomsIds.pop(),n&&e[n].classList.remove("active")};s.expose({clearAllActive:V});const M=()=>r.createVNode("ul",{class:c("left"),ref:d},[p.value.map(e=>A(e))]),W=()=>r.createVNode("ul",{class:c("right"),ref:m},[$.value.map(e=>A(e,"right"))]),A=(e,n="left")=>r.createVNode("li",{class:[c(`${n}__item`),t.heightScroll?"":"fullParent"],key:e.id,"data-id":e.id,onClick:E.bind(this,e)},[e.name]),L=e=>r.createVNode("svg",{class:c("center"),ref:g},[r.createVNode("defs",null,[r.createVNode("filter",{id:"glow",x:"-50%",y:"-50%",width:"200%",height:"200%"},null)]),i.svg_path_d.map((n,l)=>P(n,i.svg_path_ids[l]))]),P=(e,n)=>r.createVNode("path",{class:c("center__line"),d:e,"data-id":n},null);return()=>r.withDirectives(r.createVNode("div",{class:c(),style:{height:t.heightScroll?t.height+"px":"auto",width:t.width+"px"}},[t.heightScroll?r.createVNode("div",{class:c("scroll-wrapper")},[r.createVNode("div",{class:c("scroll")},[M(),L(),W()])]):r.createVNode("div",{class:c("scroll")},[M(),L(),W()])]),[[r.resolveDirective("css"),u.value||{}]])}}),H=O(q,"sankey-diagram");exports.SankeyDiagram=H;exports.default=H;
